(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8005],{5531:function(e,t,a){"use strict";a.d(t,{Z:function(){return x}});var s=a(2265);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),l=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim(),d=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:i="",children:l,iconNode:o,...x},m)=>(0,s.createElement)("svg",{ref:m,...c,width:t,height:t,stroke:e,strokeWidth:r?24*Number(a)/Number(t):a,className:n("lucide",i),...!l&&!d(x)&&{"aria-hidden":"true"},...x},[...o.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(l)?l:[l]])),x=(e,t)=>{let a=(0,s.forwardRef)(({className:a,...i},d)=>(0,s.createElement)(o,{ref:d,iconNode:t,className:n(`lucide-${r(l(e))}`,`lucide-${e}`,a),...i}));return a.displayName=l(e),a}},6637:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(5531);let r=(0,s.Z)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},7311:function(e,t,a){Promise.resolve().then(a.bind(a,3301))},3301:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var s,r,i=a(7437),l=a(2265),n=a(2849),d=a(4968),c=a(762);(s=r||(r={})).DRAFT="draft",s.SUBMITTED="submitted",s.APPROVED="approved",s.REJECTED="rejected",s.EXPIRED="expired";class o{async getPendingRequests(){let e=await c.Z.get("/research-requests/pending");return e.data}async getRequestDetails(e){let t=await c.Z.get("/research-requests/".concat(e));return t.data}async approveRequest(e,t){let a=await c.Z.post("/research-requests/".concat(e,"/approve"),{approved:!0,approvalNotes:t});return a.data}async rejectRequest(e,t){let a=await c.Z.post("/research-requests/".concat(e,"/approve"),{approved:!1,rejectionReason:t});return a.data}}var x=new o,m=a(6637),h=a(5531);let u=(0,h.Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),p=(0,h.Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),g=(0,h.Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),y=(0,h.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function f(){let{user:e,isAuthenticated:t,isLoading:a}=(0,n.useAuth)(),[s,r]=(0,l.useState)([]),[c,o]=(0,l.useState)(!0),[h,f]=(0,l.useState)(null),[j,b]=(0,l.useState)(null),[v,N]=(0,l.useState)(!1),[w,k]=(0,l.useState)(!1),[C,q]=(0,l.useState)(""),[D,P]=(0,l.useState)(null);(0,l.useEffect)(()=>{if(!a&&!t){window.location.href="/login";return}t&&S()},[t,a]);let S=async()=>{try{o(!0);let e=await x.getPendingRequests();r(e)}catch(e){console.error("Failed to fetch pending requests:",e),f("Gagal memuat daftar permintaan penelitian.")}finally{o(!1)}},E=async e=>{if(confirm('Setujui permintaan penelitian "'.concat(e.title,'"? Peneliti akan mendapatkan akses ke statistik yang diminta.')))try{P(e.id),await x.approveRequest(e.id),alert("Permintaan berhasil disetujui."),N(!1),S()}catch(e){var t,a;console.error("Failed to approve request:",e),alert((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Gagal menyetujui permintaan.")}finally{P(null)}},R=async()=>{if(j&&C.trim())try{P(j.id),await x.rejectRequest(j.id,C),alert("Permintaan berhasil ditolak."),k(!1),N(!1),q(""),S()}catch(a){var e,t;console.error("Failed to reject request:",a),alert((null===(t=a.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Gagal menolak permintaan.")}finally{P(null)}},A=e=>{b(e),k(!0)},Z=e=>{b(e),N(!0)};return a||c?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):(0,i.jsxs)(d.A,{children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Persetujuan Penelitian"}),(0,i.jsx)("p",{className:"text-gray-600 mt-1",children:"Review dan kelola permintaan data penelitian dari pengguna."})]}),h&&(0,i.jsx)("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg mb-6 border border-red-200",children:h}),(0,i.jsx)("div",{className:"bg-white rounded-lg shadow border overflow-hidden",children:0===s.length?(0,i.jsxs)("div",{className:"p-12 text-center text-gray-500",children:[(0,i.jsx)(m.Z,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Tidak ada permintaan menunggu"}),(0,i.jsx)("p",{children:"Semua permintaan penelitian telah diproses."})]}):(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,i.jsx)("thead",{className:"bg-gray-50",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Judul Penelitian"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Peneliti"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal Submit"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Est. Pasien"}),(0,i.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),(0,i.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>(0,i.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,i.jsxs)("td",{className:"px-6 py-4",children:[(0,i.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,i.jsx)("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:e.description})]}),(0,i.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(u,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,i.jsx)("div",{className:"text-sm text-gray-900",children:e.requesterName})]}),(0,i.jsx)("div",{className:"text-xs text-gray-500 ml-6",children:e.requesterEmail})]}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,i.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,i.jsx)(p,{className:"h-4 w-4 mr-2"}),new Date(e.submittedAt).toLocaleDateString("id-ID")]})}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,i.jsx)("div",{className:"text-sm text-gray-900",children:e.patientCount?e.patientCount.toLocaleString():"-"})}),(0,i.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[(0,i.jsx)("button",{onClick:()=>Z(e),className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-50 text-gray-700",children:"Detail"}),(0,i.jsxs)("button",{onClick:()=>E(e),disabled:D===e.id,className:"px-3 py-1 bg-green-600 rounded hover:bg-green-700 text-white flex items-center inline-flex",children:[(0,i.jsx)(g,{className:"h-4 w-4 mr-1"}),"Setuju"]}),(0,i.jsxs)("button",{onClick:()=>A(e),disabled:D===e.id,className:"px-3 py-1 bg-red-600 rounded hover:bg-red-700 text-white flex items-center inline-flex",children:[(0,i.jsx)(y,{className:"h-4 w-4 mr-1"}),"Tolak"]})]})]},e.id))})]})})}),v&&j&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto flex flex-col",children:[(0,i.jsxs)("div",{className:"p-6 border-b",children:[(0,i.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Detail Permintaan Penelitian"}),(0,i.jsxs)("p",{className:"text-sm text-gray-500",children:["ID: ",j.id]})]}),(0,i.jsxs)("div",{className:"p-6 space-y-6 overflow-y-auto flex-1",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-gray-500",children:"Judul"}),(0,i.jsx)("p",{className:"text-gray-900",children:j.title})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-gray-500",children:"IRB / No. Ethics"}),(0,i.jsx)("p",{className:"text-gray-900",children:j.irbNumber||"-"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-gray-500",children:"Deskripsi"}),(0,i.jsx)("p",{className:"text-gray-900 text-sm whitespace-pre-wrap",children:j.description})]}),(0,i.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Filter Data Yang Diminta"}),(0,i.jsx)("pre",{className:"text-xs text-gray-600 overflow-x-auto",children:JSON.stringify(j.filters,null,2)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-gray-500",children:"Justifikasi Ilmiah"}),(0,i.jsx)("p",{className:"text-gray-900 text-sm",children:j.justification||"Tidak ada justifikasi disertakan."})]}),(0,i.jsxs)("div",{className:"border-t pt-4 flex justify-between items-center",children:[(0,i.jsxs)("div",{className:"text-sm text-gray-500",children:["Diajukan oleh: ",(0,i.jsx)("span",{className:"font-semibold text-gray-900",children:j.requesterName})," (",j.requesterEmail,")"]}),(0,i.jsxs)("div",{className:"text-sm text-gray-500",children:["Tanggal: ",new Date(j.submittedAt).toLocaleDateString("id-ID",{dateStyle:"full"})]})]})]}),(0,i.jsxs)("div",{className:"p-6 border-t flex justify-end space-x-2 bg-gray-50",children:[(0,i.jsx)("button",{onClick:()=>N(!1),className:"px-4 py-2 border bg-white rounded-md text-gray-700 hover:bg-gray-50",children:"Tutup"}),(0,i.jsx)("button",{onClick:()=>{j&&A(j)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Tolak"}),(0,i.jsx)("button",{onClick:()=>{j&&E(j)},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Setujui Permintaan"})]})]})}),w&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-lg",children:[(0,i.jsxs)("div",{className:"p-6 border-b",children:[(0,i.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Tolak Permintaan"}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"Mohon berikan alasan penolakan untuk peneliti."})]}),(0,i.jsx)("div",{className:"p-6",children:(0,i.jsx)("textarea",{placeholder:"Alasan penolakan...",value:C,onChange:e=>q(e.target.value),rows:4,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-green-500 focus:outline-none"})}),(0,i.jsxs)("div",{className:"p-6 border-t flex justify-end space-x-2 bg-gray-50",children:[(0,i.jsx)("button",{onClick:()=>k(!1),className:"px-4 py-2 border bg-white rounded-md text-gray-700 hover:bg-gray-50",children:"Batal"}),(0,i.jsx)("button",{onClick:R,disabled:!C.trim(),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:"Konfirmasi Penolakan"})]})]})})]})}},4033:function(e,t,a){e.exports=a(94)}},function(e){e.O(0,[1176,4829,2849,4968,2971,2472,1744],function(){return e(e.s=7311)}),_N_E=e.O()}]);