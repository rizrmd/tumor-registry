(()=>{var e={};e.id=9284,e.ids=[9284],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},366:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>o,routeModule:()=>m,tree:()=>c});var a=s(482),r=s(9108),i=s(2563),l=s.n(i),n=s(8300),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);s.d(t,d);let c=["",{children:["research",{children:["requests",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7739)),"D:\\Project\\Tumor Registry\\INAMSOS Application Desktop\\frontend\\src\\app\\research\\requests\\new\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,8549)),"D:\\Project\\Tumor Registry\\INAMSOS Application Desktop\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,8206)),"D:\\Project\\Tumor Registry\\INAMSOS Application Desktop\\frontend\\src\\app\\not-found.tsx"]}],o=["D:\\Project\\Tumor Registry\\INAMSOS Application Desktop\\frontend\\src\\app\\research\\requests\\new\\page.tsx"],u="/research/requests/new/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/research/requests/new/page",pathname:"/research/requests/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},4809:(e,t,s)=>{Promise.resolve().then(s.bind(s,9112))},9112:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(2295),r=s(3729),i=s(2254),l=s(3973),n=s(2528),d=s(9998);function c({formData:e,updateFormData:t}){let{user:s}=(0,l.useAuth)();return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Informasi Penelitian"}),a.jsx("p",{className:"text-gray-600",children:"Detail penelitian dan identitas peneliti"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Informasi Peneliti (Auto-fill)"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Nama:"})," ",a.jsx("span",{className:"font-medium",children:s?.name})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Email:"})," ",a.jsx("span",{className:"font-medium",children:s?.email})]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"No. HP (Opsional)"}),a.jsx("input",{type:"tel",value:e.researcherPhone||"",onChange:e=>t("researcherPhone",e.target.value),placeholder:"+62",className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Judul Penelitian ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("input",{type:"text",value:e.title||"",onChange:e=>t("title",e.target.value),placeholder:"Judul lengkap penelitian Anda",className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tipe Penelitian ",a.jsx("span",{className:"text-red-600",children:"*"})]}),(0,a.jsxs)("select",{value:e.researchType||"",onChange:e=>t("researchType",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0,children:[a.jsx("option",{value:"",children:"Pilih tipe penelitian"}),a.jsx("option",{value:"ACADEMIC",children:"Akademik (Skripsi/Tesis/Disertasi)"}),a.jsx("option",{value:"CLINICAL_TRIAL",children:"Clinical Trial"}),a.jsx("option",{value:"OBSERVATIONAL",children:"Observational Study"}),a.jsx("option",{value:"SYSTEMATIC_REVIEW",children:"Systematic Review"}),a.jsx("option",{value:"META_ANALYSIS",children:"Meta-analysis"}),a.jsx("option",{value:"OTHER",children:"Lainnya"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Abstrak Singkat ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("textarea",{value:e.researchAbstract||"",onChange:e=>t("researchAbstract",e.target.value),placeholder:"Ringkasan singkat penelitian Anda (max 500 karakter)",rows:4,maxLength:500,className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[(e.researchAbstract||"").length,"/500 karakter"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tujuan Penelitian ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("textarea",{value:e.objectives||"",onChange:e=>t("objectives",e.target.value),placeholder:"Tujuan utama penelitian (max 300 karakter)",rows:3,maxLength:300,className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[(e.objectives||"").length,"/300 karakter"]})]})]})}function o({formData:e,updateFormData:t}){let[s,i]=(0,r.useState)(null),[l,n]=(0,r.useState)(!1),c=e.dataFilters||{},o=(e,s)=>{t("dataFilters",{...c,[e]:s})},u=async()=>{if(!c.periodStart||!c.periodEnd){alert("Silakan pilih periode data terlebih dahulu");return}n(!0);try{let e=await d.Z.estimatePatients(c);i(e.estimatedCount),t("estimatedPatientCount",e.estimatedCount)}catch(e){console.error("Error estimating:",e),alert("Gagal menghitung estimasi. Silakan coba lagi.")}finally{n(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Kriteria Data"}),a.jsx("p",{className:"text-gray-600",children:"Filter pasien dan estimasi jumlah data"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Periode Data - Dari ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("input",{type:"date",value:c.periodStart||"",onChange:e=>o("periodStart",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Sampai ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("input",{type:"date",value:c.periodEnd||"",onChange:e=>o("periodEnd",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jenis Tumor"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",value:"bone_tumor",className:"rounded"}),a.jsx("span",{children:"Bone Tumor"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",value:"soft_tissue_tumor",className:"rounded"}),a.jsx("span",{children:"Soft Tissue Tumor"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",value:"metastatic_bone_disease",className:"rounded"}),a.jsx("span",{children:"Metastatic Bone Disease"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Usia Min (tahun)"}),a.jsx("input",{type:"number",value:c.ageMin||"",onChange:e=>o("ageMin",parseInt(e.target.value)),min:"0",max:"120",className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Usia Max (tahun)"}),a.jsx("input",{type:"number",value:c.ageMax||"",onChange:e=>o("ageMax",parseInt(e.target.value)),min:"0",max:"120",className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsx("div",{className:"border-t pt-4",children:a.jsx("button",{onClick:u,disabled:l,className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:l?"Menghitung...":"\uD83D\uDD0D Hitung Estimasi Pasien"})}),null!==s&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm text-green-600 mb-1",children:"Estimasi Jumlah Pasien"}),(0,a.jsxs)("div",{className:"text-4xl font-bold text-green-900",children:["~",s]}),a.jsx("div",{className:"text-sm text-green-700 mt-1",children:"pasien sesuai kriteria Anda"})]})})]})}function u({formData:e,updateFormData:t}){return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Timeline & Submit"}),a.jsx("p",{className:"text-gray-600",children:"Tentukan timeline penelitian dan submit request Anda"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tanggal Mulai Penelitian ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("input",{type:"date",value:e.researchStart||"",onChange:e=>t("researchStart",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tanggal Selesai ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("input",{type:"date",value:e.researchEnd||"",onChange:e=>t("researchEnd",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Durasi Akses Data ",a.jsx("span",{className:"text-red-600",children:"*"})]}),(0,a.jsxs)("select",{value:e.accessDurationMonths||"",onChange:e=>t("accessDurationMonths",parseInt(e.target.value)),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0,children:[a.jsx("option",{value:"",children:"Pilih durasi"}),a.jsx("option",{value:"3",children:"3 bulan"}),a.jsx("option",{value:"6",children:"6 bulan (recommended)"}),a.jsx("option",{value:"12",children:"12 bulan"}),a.jsx("option",{value:"24",children:"24 bulan"})]})]}),a.jsx("div",{className:"border-t pt-4",children:(0,a.jsxs)("label",{className:"flex items-start gap-3 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:e.agreementSigned||!1,onChange:e=>{t("agreementSigned",e.target.checked),e.target.checked&&t("agreementDate",new Date().toISOString())},className:"mt-1 h-5 w-5 text-blue-600 rounded",required:!0}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("div",{className:"font-semibold text-gray-900 mb-2",children:["Data Protection Agreement ",a.jsx("span",{className:"text-red-600",children:"*"})]}),(0,a.jsxs)("div",{className:"text-gray-700 space-y-1",children:[a.jsx("p",{children:"✓ Data hanya akan digunakan untuk tujuan penelitian yang disebutkan"}),a.jsx("p",{children:"✓ Data tidak akan dibagikan kepada pihak ketiga tanpa izin INAMSOS"}),a.jsx("p",{children:"✓ Publikasi akan mencantumkan acknowledgment ke INAMSOS"}),a.jsx("p",{children:"✓ Data akan dihapus setelah penelitian selesai"})]})]})]})})]})}let x=[{key:"demographics",label:"Demographics & Identity (Basic)",description:"Age, gender, provinsi/region only (TIDAK termasuk alamat lengkap)",sensitivityLevel:"LOW",sensitivityScore:10},{key:"demographicsIdentifiable",label:"Demographics Identifiable ⚠️",description:"NIK, Full Name, Full Address",sensitivityLevel:"VERY HIGH",sensitivityScore:40,requiresExtra:"Requires IRB approval + extra justification"},{key:"clinicalPresentation",label:"Clinical Presentation",description:"Chief complaint, symptoms, Karnofsky score, tumor size",sensitivityLevel:"LOW",sensitivityScore:5},{key:"diagnosisClassification",label:"Diagnosis & Classification ⭐",description:"WHO classification, tumor location, histopathology grade",sensitivityLevel:"LOW",sensitivityScore:5},{key:"stagingData",label:"Staging Data ⭐",description:"Enneking, AJCC staging, tumor size, metastasis status",sensitivityLevel:"LOW",sensitivityScore:5},{key:"diagnosticInvestigations",label:"Diagnostic Investigations",description:"Biopsy results, imaging studies, laboratory results, radiology findings",sensitivityLevel:"MEDIUM",sensitivityScore:10},{key:"treatmentManagement",label:"Treatment Management",description:"Surgery details, chemotherapy, radiotherapy, reconstruction",sensitivityLevel:"MEDIUM",sensitivityScore:10},{key:"followUpOutcomes",label:"Follow-up & Outcomes",description:"14-visit follow-up data, MSTS scores, recurrence, survival",sensitivityLevel:"MEDIUM",sensitivityScore:10},{key:"clinicalPhotosImaging",label:"Clinical Photos & Imaging Files ⚠️",description:"Clinical photographs and imaging files",sensitivityLevel:"VERY HIGH",sensitivityScore:35,requiresExtra:"Requires patient consent verification + IRB approval"},{key:"cpcRecords",label:"CPC Conference Records",description:"Multidisciplinary team conference notes and recommendations",sensitivityLevel:"LOW",sensitivityScore:5}];function m({formData:e,updateFormData:t}){let[s,i]=(0,r.useState)(e.requestedDataFields||{}),[l,n]=(0,r.useState)(0),c=e=>{let s=d.Z.getPresetDataFields(e);i(s),t("requestedDataFields",s),m(s)},o=e=>{let a={...s};a[e]?.selected?a[e]={selected:!1,justification:""}:a[e]={selected:!0,justification:a[e]?.justification||""},i(a),t("requestedDataFields",a),m(a)},u=(e,a)=>{let r={...s,[e]:{...s[e],justification:a}};i(r),t("requestedDataFields",r)},m=e=>{let t=0;x.forEach(s=>{e[s.key]?.selected&&(t+=s.sensitivityScore)}),n(Math.min(t,100))},p=e=>e<=25?"LOW":e<=50?"MEDIUM":e<=75?"HIGH":"VERY HIGH",h=e=>{switch(e){case"LOW":return"bg-green-100 text-green-800";case"MEDIUM":return"bg-yellow-100 text-yellow-800";case"HIGH":return"bg-orange-100 text-orange-800";case"VERY HIGH":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},g=Object.values(s).filter(e=>e?.selected).length;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Data Fields Selection"}),a.jsx("p",{className:"text-gray-600",children:"Centang kategori data yang Anda butuhkan. Justifikasi WAJIB untuk setiap kategori yang dipilih."})]}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-3",children:"\uD83D\uDCA1 Quick Presets (Pilih Cepat):"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[a.jsx("button",{onClick:()=>c("basic_research"),className:"px-4 py-2 bg-white border border-blue-300 rounded text-sm hover:bg-blue-100 text-blue-900",children:"Basic Research"}),a.jsx("button",{onClick:()=>c("outcome_study"),className:"px-4 py-2 bg-white border border-blue-300 rounded text-sm hover:bg-blue-100 text-blue-900",children:"Outcome Study"}),a.jsx("button",{onClick:()=>c("survival_analysis"),className:"px-4 py-2 bg-white border border-blue-300 rounded text-sm hover:bg-blue-100 text-blue-900",children:"Survival Analysis"}),a.jsx("button",{onClick:()=>c("treatment_comparison"),className:"px-4 py-2 bg-white border border-blue-300 rounded text-sm hover:bg-blue-100 text-blue-900",children:"Treatment Comparison"})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Data Sensitivity Score"}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[l,"/100"]})]}),(0,a.jsxs)("div",{className:`px-4 py-2 rounded-full text-sm font-semibold ${h(p(l))}`,children:[p(l)," SENSITIVITY"]})]}),a.jsx("div",{className:"space-y-3",children:x.map(e=>{let t=s[e.key]?.selected||!1,r=s[e.key]?.justification||"";return a.jsx("div",{className:`border rounded-lg p-4 transition-all ${t?"border-blue-500 bg-blue-50":"border-gray-300 bg-white"}`,children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("input",{type:"checkbox",checked:t,onChange:()=>o(e.key),className:"mt-1 h-5 w-5 text-blue-600 rounded focus:ring-blue-500"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{className:"text-lg font-semibold text-gray-900 cursor-pointer",onClick:()=>o(e.key),children:e.label}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${h(e.sensitivityLevel)}`,children:e.sensitivityLevel}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["+",e.sensitivityScore," pts"]})]})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),e.requiresExtra&&(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-2 text-xs text-yellow-800 mb-2",children:["⚠️ ",e.requiresExtra]}),t&&(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Justifikasi (WAJIB) ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("textarea",{value:r,onChange:t=>u(e.key,t.target.value),placeholder:`Jelaskan kenapa data ${e.label} diperlukan untuk penelitian Anda...`,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:t}),r.length>0&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[r.length," karakter"]})]})]})]})},e.key)})}),a.jsx("div",{className:"bg-gray-100 border border-gray-300 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Total Kategori Dipilih"}),(0,a.jsxs)("div",{className:"text-xl font-bold text-gray-900",children:[g," dari ",x.length]})]}),g>0&&a.jsx("div",{className:"text-sm text-gray-600",children:g===x.length?a.jsx("span",{className:"text-orange-600 font-semibold",children:"⚠️ Full dataset request"}):a.jsx("span",{className:"text-green-600",children:"✓ Selective data request"})})]})}),l>75&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"text-red-600 text-xl",children:"⚠️"}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-semibold text-red-900 mb-1",children:"VERY HIGH Sensitivity Request"}),a.jsx("p",{className:"text-sm text-red-800",children:"This request includes highly sensitive data (NIK/Name or Clinical Photos). Expect longer review time and possible additional requirements from ethics committee."})]})]})}),0===g&&a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center",children:a.jsx("p",{className:"text-yellow-800",children:"Silakan pilih minimal 1 kategori data untuk melanjutkan."})})]})}let p=[{id:1,title:"Informasi Penelitian",description:"Detail penelitian dan peneliti"},{id:2,title:"Kriteria Data",description:"Filter dan estimasi pasien"},{id:3,title:"Data Fields",description:"Pilih kategori data yang dibutuhkan"},{id:4,title:"Timeline & Submit",description:"Timeline penelitian dan submit"}];function h({onComplete:e,onSaveDraft:t,initialData:s}){let[i,l]=(0,r.useState)(1),[n,d]=(0,r.useState)(s||{}),[x,h]=(0,r.useState)(!1),[g,b]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=setInterval(()=>{Object.keys(n).length>0&&y()},12e4);return()=>clearInterval(e)},[n]);let y=async()=>{h(!0);try{await t(n),b(new Date)}catch(e){console.error("Error saving draft:",e)}finally{h(!1)}},j=(e,t)=>{d(s=>({...s,[e]:t}))},v=e=>{switch(e){case 1:return!!(n.title&&n.researchType&&n.researchAbstract&&n.objectives);case 2:return!!n.dataFilters;case 3:return!!(n.requestedDataFields&&f(n.requestedDataFields));case 4:return!!(n.irbStatus&&n.researchStart&&n.researchEnd&&n.accessDurationMonths&&n.agreementSigned);default:return!1}},f=e=>Object.values(e).some(e=>e?.selected),N=async()=>{if(v(4))try{await e(n)}catch(e){console.error("Error submitting request:",e),alert("Gagal submit request. Silakan coba lagi.")}};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[a.jsx("div",{className:"mb-8",children:a.jsx("div",{className:"flex items-center justify-between mb-4",children:p.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center flex-1",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center flex-1",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-semibold ${i===e.id?"bg-blue-600 text-white":i>e.id?"bg-green-600 text-white":"bg-gray-300 text-gray-600"}`,children:i>e.id?"✓":e.id}),(0,a.jsxs)("div",{className:"mt-2 text-center",children:[a.jsx("div",{className:`text-sm font-medium ${i===e.id?"text-blue-600":"text-gray-700"}`,children:e.title}),a.jsx("div",{className:"text-xs text-gray-500",children:e.description})]})]}),t<p.length-1&&a.jsx("div",{className:`h-1 flex-1 mx-4 ${i>e.id?"bg-green-600":"bg-gray-300"}`})]},e.id))})}),a.jsx("div",{className:"mb-4 text-right text-sm text-gray-500",children:x?(0,a.jsxs)("span",{className:"flex items-center justify-end gap-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),"Menyimpan draft..."]}):g?(0,a.jsxs)("span",{children:["Terakhir disimpan: ",g.toLocaleTimeString("id-ID")]}):null}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-6",children:[1===i&&a.jsx(c,{formData:n,updateFormData:j}),2===i&&a.jsx(o,{formData:n,updateFormData:j}),3===i&&a.jsx(m,{formData:n,updateFormData:j}),4===i&&a.jsx(u,{formData:n,updateFormData:j})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("div",{children:i>1&&a.jsx("button",{onClick:()=>{i>1&&l(i-1)},className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"← Kembali"})}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:y,disabled:x,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:x?"Menyimpan...":"Simpan Draft"}),i<4?a.jsx("button",{onClick:()=>{v(i)&&i<4&&(l(i+1),y())},disabled:!v(i),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Lanjut →"}):a.jsx("button",{onClick:N,disabled:!v(4),className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Submit untuk Approval"})]})]})]})}function g(){let{isAuthenticated:e,isLoading:t}=(0,l.useAuth)(),s=(0,i.useRouter)(),[c,o]=(0,r.useState)(null);if((0,r.useEffect)(()=>{t||e||s.push("/login")},[e,t,s]),t)return a.jsx(n.A,{children:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})});if(!e)return null;let u=async e=>{try{let t=c;if(c)await d.Z.update(c,e);else{let s=await d.Z.create(e);t=s.id,o(s.id)}t&&(await d.Z.submit(t),alert("✅ Research request berhasil di-submit untuk approval!"),s.push("/research/requests"))}catch(t){console.error("Error submitting request:",t);let e=t.response?.data?.message||"Terjadi kesalahan saat submit request";alert(`❌ Gagal submit request: ${e}`)}},x=async e=>{try{if(c)await d.Z.update(c,e);else{let t=await d.Z.create(e);o(t.id)}}catch(e){console.error("Error saving draft:",e)}};return a.jsx(n.A,{children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Research Data Request"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Permintaan akses data untuk penelitian muskuloskeletal tumor"}),a.jsx("div",{className:"mt-4 inline-flex items-center px-4 py-2 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:"4 Langkah - Checklist-Based Selection"})]}),a.jsx(h,{onComplete:u,onSaveDraft:x})]})})}},7739:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>r,default:()=>l});let a=(0,s(6843).createProxy)(String.raw`D:\Project\Tumor Registry\INAMSOS Application Desktop\frontend\src\app\research\requests\new\page.tsx`),{__esModule:r,$$typeof:i}=a,l=a.default}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[7141,4192,2528,4786],()=>s(366));module.exports=a})();