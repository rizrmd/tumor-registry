(()=>{var e={};e.id=9029,e.ids=[9029],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},1148:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=a(482),r=a(9108),i=a(2563),l=a.n(i),n=a(8300),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let d=["",{children:["patients",{children:["view",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,8717)),"D:\\Project\\Tumor Registry\\INAMSOS Application Desktop\\frontend\\src\\app\\patients\\view\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,8549)),"D:\\Project\\Tumor Registry\\INAMSOS Application Desktop\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,8206)),"D:\\Project\\Tumor Registry\\INAMSOS Application Desktop\\frontend\\src\\app\\not-found.tsx"]}],c=["D:\\Project\\Tumor Registry\\INAMSOS Application Desktop\\frontend\\src\\app\\patients\\view\\page.tsx"],m="/patients/view/page",x={require:a,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/patients/view/page",pathname:"/patients/view",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2050:(e,t,a)=>{Promise.resolve().then(a.bind(a,7718))},7718:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(2295),r=a(3729),i=a(2254),l=a(5321),n=a(4573),o=a(5923);function d({patientId:e,patientName:t}){let[a,i]=(0,r.useState)(!0),[l,n]=(0,r.useState)([]),[d,c]=(0,r.useState)(null),[m,x]=(0,r.useState)(!1),[p,g]=(0,r.useState)(!1),[h,u]=(0,r.useState)(null),[y,b]=(0,r.useState)(""),[j,f]=(0,r.useState)(""),[N,v]=(0,r.useState)("");(0,r.useEffect)(()=>{w()},[e]);let w=async()=>{try{i(!0);let t=await o.Z.getPhotosByPatient(e);n(Array.isArray(t)?t:[])}catch(e){console.error("Error loading clinical photos:",e),n([])}finally{i(!1)}},S=async()=>{if(!h){alert("Please select a file");return}try{x(!0),await o.Z.uploadPhoto({patientId:e,file:h,viewType:j,description:N}),alert("Photo uploaded successfully!"),u(null),b(""),f(""),v(""),g(!1),w()}catch(e){console.error("Error uploading photo:",e),alert("Failed to upload photo. Please try again.")}finally{x(!1)}},T=async e=>{if(confirm("Are you sure you want to delete this photo?"))try{await o.Z.deletePhoto(e),alert("Photo deleted successfully"),w(),c(null)}catch(e){console.error("Error deleting photo:",e),alert("Failed to delete photo")}},D=e=>{let t={ANTERIOR:"bg-blue-100 text-blue-800",POSTERIOR:"bg-green-100 text-green-800",LATERAL_LEFT:"bg-purple-100 text-purple-800",LATERAL_RIGHT:"bg-pink-100 text-pink-800",OTHER:"bg-gray-100 text-gray-800"}[e||""]||"bg-gray-100 text-gray-800";return s.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t}`,children:e||"Unknown"})};return a?s.jsx("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading photos..."})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Clinical Photos"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[l.length," photos for ",t]})]}),(0,s.jsxs)("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center",children:[s.jsx("span",{className:"mr-2",children:"\uD83D\uDCF8"}),"Upload Photo"]})]}),0===l.length?(0,s.jsxs)("div",{className:"p-12 text-center text-gray-500 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDCF8"}),s.jsx("p",{className:"text-lg font-medium",children:"No clinical photos yet"}),s.jsx("p",{className:"text-sm mt-2",children:"Upload clinical photos to document this patient's condition"}),s.jsx("button",{onClick:()=>g(!0),className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Upload First Photo"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map((e,t)=>(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>c(e),children:[(0,s.jsxs)("div",{className:"aspect-square bg-gray-100 relative",children:[s.jsx("img",{src:e.preview,alt:e.description||"Clinical photo",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute top-2 right-2",children:D(e.viewAngle)})]}),(0,s.jsxs)("div",{className:"p-4",children:[s.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:e.description||"No description"}),s.jsx("p",{className:"text-xs text-gray-400 mt-2",children:new Date(e.file.lastModified).toLocaleDateString("id-ID")})]})]},`${e.preview}-${t}`))}),p&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Upload Clinical Photo"}),s.jsx("button",{onClick:()=>!m&&g(!1),className:"text-gray-400 hover:text-gray-600",disabled:m,children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Patient: ",t]})]}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Photo File *"}),s.jsx("input",{type:"file",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];if(!t)return;if(!t.type.startsWith("image/")){alert("Please select an image file");return}if(t.size>10485760){alert("File size must be less than 10MB");return}u(t);let a=new FileReader;a.onloadend=()=>{b(a.result)},a.readAsDataURL(t)},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:m}),y&&s.jsx("div",{className:"mt-4",children:s.jsx("img",{src:y,alt:"Preview",className:"w-full max-h-64 object-contain rounded-lg border border-gray-200"})})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"View Type"}),(0,s.jsxs)("select",{value:j,onChange:e=>f(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:m,children:[s.jsx("option",{value:"",children:"Select view type"}),s.jsx("option",{value:"ANTERIOR",children:"Anterior"}),s.jsx("option",{value:"POSTERIOR",children:"Posterior"}),s.jsx("option",{value:"LATERAL_LEFT",children:"Lateral Left"}),s.jsx("option",{value:"LATERAL_RIGHT",children:"Lateral Right"}),s.jsx("option",{value:"OTHER",children:"Other"})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),s.jsx("textarea",{value:N,onChange:e=>v(e.target.value),rows:3,placeholder:"Photo description (optional)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:m})]})]}),(0,s.jsxs)("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[s.jsx("button",{onClick:()=>g(!1),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",disabled:m,children:"Cancel"}),s.jsx("button",{onClick:S,disabled:m||!h,className:"px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:m?"Uploading...":"Upload Photo"})]})]})}),d&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Clinical Photo Detail"}),s.jsx("button",{onClick:()=>c(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,s.jsxs)("div",{className:"p-6",children:[s.jsx("div",{className:"mb-6",children:s.jsx("img",{src:d.preview,alt:d.description||"Clinical photo",className:"w-full rounded-lg"})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Patient"}),s.jsx("p",{className:"font-semibold",children:t})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"View Type"}),s.jsx("div",{className:"mt-1",children:D(d.viewAngle)})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Description"}),s.jsx("p",{className:"font-semibold",children:d.description||"No description"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"File Size"}),s.jsx("p",{className:"font-semibold",children:d.file.size?`${(d.file.size/1024).toFixed(1)} KB`:"Unknown"})]})]}),d.description&&(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Description"}),s.jsx("p",{className:"text-gray-900",children:d.description})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{onClick:()=>window.open(d.preview,"_blank"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Download"}),s.jsx("button",{onClick:()=>T(d.preview),className:"px-6 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Delete"})]})]})]})})]})}var c=a(6735);function m({patientId:e,patientName:t}){let[a,i]=(0,r.useState)(!0),[l,n]=(0,r.useState)([]),[o,d]=(0,r.useState)(null),[m,x]=(0,r.useState)("all");(0,r.useEffect)(()=>{p()},[e]);let p=async()=>{try{i(!0);let t=await c.ZP.getImagesByPatient(e);n(t)}catch(e){console.error("Error loading radiology images:",e),n([])}finally{i(!1)}},g="all"===m?l:l.filter(e=>e.modality===m),h=e=>{let t={XRAY:"bg-blue-100 text-blue-800",CT:"bg-purple-100 text-purple-800",MRI:"bg-pink-100 text-pink-800",ULTRASOUND:"bg-green-100 text-green-800","PET-SCAN":"bg-red-100 text-red-800","BONE-SCAN":"bg-yellow-100 text-yellow-800"}[e]||"bg-gray-100 text-gray-800";return s.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t}`,children:e})};return a?s.jsx("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading radiology images..."})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Radiology Images"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[l.length," images for ",t]})]}),s.jsx("div",{children:(0,s.jsxs)("select",{value:m,onChange:e=>x(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"All Modalities"}),s.jsx("option",{value:"XRAY",children:"X-Ray"}),s.jsx("option",{value:"CT",children:"CT Scan"}),s.jsx("option",{value:"MRI",children:"MRI"}),s.jsx("option",{value:"ULTRASOUND",children:"Ultrasound"}),s.jsx("option",{value:"PET-SCAN",children:"PET Scan"}),s.jsx("option",{value:"BONE-SCAN",children:"Bone Scan"})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"X-Ray"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:l.filter(e=>"XRAY"===e.modality).length})]}),(0,s.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"CT Scan"}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:l.filter(e=>"CT"===e.modality).length})]}),(0,s.jsxs)("div",{className:"bg-pink-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm text-pink-600 font-medium",children:"MRI"}),s.jsx("p",{className:"text-2xl font-bold text-pink-900",children:l.filter(e=>"MRI"===e.modality).length})]}),(0,s.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Ultrasound"}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:l.filter(e=>"ULTRASOUND"===e.modality).length})]})]}),0===g.length?(0,s.jsxs)("div",{className:"p-12 text-center text-gray-500 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-6xl mb-4",children:"\uD83C\uDFE5"}),s.jsx("p",{className:"text-lg font-medium",children:"No radiology images yet"}),s.jsx("p",{className:"text-sm mt-2",children:0===l.length?"Radiology images will appear here when uploaded through the patient entry form":"Try adjusting the modality filter"})]}):s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Modality"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Body Part"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Study Date"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h(e.modality)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:e.bodyPart||"-"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:new Date(e.studyDate).toLocaleDateString("id-ID")})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"text-sm text-gray-900 line-clamp-2",children:e.description||"No description"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:s.jsx("button",{onClick:()=>d(e),className:"text-blue-600 hover:text-blue-900",children:"View"})})]},e.id))})]})}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Radiology Study Detail"}),s.jsx("button",{onClick:()=>d(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,s.jsxs)("div",{className:"p-6",children:[s.jsx("div",{className:"mb-6",children:s.jsx("img",{src:c.ZP.getImageUrl(o.id),alt:`${o.modality} - ${o.bodyPart}`,className:"w-full rounded-lg bg-black"})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Study Information"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Modality"}),s.jsx("div",{className:"mt-1",children:h(o.modality)})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Body Part"}),s.jsx("p",{className:"font-medium",children:o.bodyPart||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Study Date"}),s.jsx("p",{className:"font-medium",children:new Date(o.studyDate).toLocaleDateString("id-ID")})]})]})]}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Patient Information"}),s.jsx("div",{className:"space-y-2",children:(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Patient Name"}),s.jsx("p",{className:"font-medium",children:t})]})})]})]}),o.description&&(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Description"}),s.jsx("p",{className:"text-gray-900",children:o.description})]}),o.findings&&(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Findings"}),s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:o.findings})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{onClick:()=>window.open(c.ZP.getImageUrl(o.id),"_blank"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Download"}),s.jsx("button",{onClick:()=>d(null),className:"px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Close"})]})]})]})})]})}function x({patientId:e,patientName:t}){let[a,i]=(0,r.useState)(!0),[l,n]=(0,r.useState)([]),[o,d]=(0,r.useState)(null),[c,m]=(0,r.useState)("all");(0,r.useEffect)(()=>{x()},[e]);let x=async()=>{try{i(!0),n([])}catch(e){console.error("Error loading pathology reports:",e),n([])}finally{i(!1)}},p="all"===c?l:l.filter(e=>e.reportType===c),g=e=>{let t={BIOPSY:"bg-blue-100 text-blue-800",FNAB:"bg-green-100 text-green-800",CORE_BIOPSY:"bg-purple-100 text-purple-800",SURGICAL_PATHOLOGY:"bg-pink-100 text-pink-800",CYTOLOGY:"bg-yellow-100 text-yellow-800",IHK:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800";return s.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t}`,children:e})};return a?s.jsx("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading pathology reports..."})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pathology Reports"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[l.length," reports for ",t]})]}),s.jsx("div",{children:(0,s.jsxs)("select",{value:c,onChange:e=>m(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"All Report Types"}),s.jsx("option",{value:"BIOPSY",children:"Biopsy"}),s.jsx("option",{value:"FNAB",children:"FNAB"}),s.jsx("option",{value:"CORE_BIOPSY",children:"Core Biopsy"}),s.jsx("option",{value:"SURGICAL_PATHOLOGY",children:"Surgical Pathology"}),s.jsx("option",{value:"CYTOLOGY",children:"Cytology"}),s.jsx("option",{value:"IHK",children:"IHK (Immunohistochemistry)"})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Biopsy"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:l.filter(e=>"BIOPSY"===e.reportType).length})]}),(0,s.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm text-green-600 font-medium",children:"FNAB"}),s.jsx("p",{className:"text-2xl font-bold text-green-900",children:l.filter(e=>"FNAB"===e.reportType).length})]}),(0,s.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Core Biopsy"}),s.jsx("p",{className:"text-2xl font-bold text-purple-900",children:l.filter(e=>"CORE_BIOPSY"===e.reportType).length})]})]}),0===p.length?(0,s.jsxs)("div",{className:"p-12 text-center text-gray-500 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDD2C"}),s.jsx("p",{className:"text-lg font-medium",children:"No pathology reports yet"}),s.jsx("p",{className:"text-sm mt-2",children:0===l.length?"Pathology reports will appear here when uploaded through the patient entry form":"Try adjusting the report type filter"})]}):s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Report Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Specimen Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Report Date"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Diagnosis"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g(e.reportType)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:e.specimenType||"-"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:new Date(e.reportDate).toLocaleDateString("id-ID")})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("div",{className:"text-sm text-gray-900 line-clamp-2",children:e.diagnosis||"Pending"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:s.jsx("button",{onClick:()=>d(e),className:"text-blue-600 hover:text-blue-900",children:"View"})})]},e.id))})]})}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Pathology Report Detail"}),s.jsx("button",{onClick:()=>d(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Report Information"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Report Type"}),s.jsx("div",{className:"mt-1",children:g(o.reportType)})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Specimen Type"}),s.jsx("p",{className:"font-medium",children:o.specimenType||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Report Date"}),s.jsx("p",{className:"font-medium",children:new Date(o.reportDate).toLocaleDateString("id-ID")})]}),o.pathologist&&(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Pathologist"}),s.jsx("p",{className:"font-medium",children:o.pathologist})]})]})]}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Patient Information"}),s.jsx("div",{className:"space-y-2",children:(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-xs text-gray-600",children:"Patient Name"}),s.jsx("p",{className:"font-medium",children:t})]})})]})]}),o.diagnosis&&(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Diagnosis"}),s.jsx("p",{className:"text-gray-900 bg-yellow-50 p-4 rounded-lg font-medium",children:o.diagnosis})]}),o.findings&&(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Findings"}),s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg",children:o.findings})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[o.fileUrl&&s.jsx("button",{onClick:()=>window.open(o.fileUrl,"_blank"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Download Report"}),s.jsx("button",{onClick:()=>d(null),className:"px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Close"})]})]})]})})]})}function p({patient:e,onEdit:t,className:a=""}){var n,o,c;let p=(0,i.useRouter)(),{updatePatient:g}=(0,l.l)(),[h,u]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),[j,f]=(0,r.useState)("info"),[N,v]=(0,r.useState)({dateOfDeath:"",causeOfDeath:""}),w=e=>e?new Date(e).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}):"-",S=async()=>{try{await g(e.id,{isDeceased:!0,dateOfDeath:N.dateOfDeath,causeOfDeath:N.causeOfDeath}),b(!1),v({dateOfDeath:"",causeOfDeath:""})}catch(e){console.error("Failed to mark patient as deceased:",e)}};return(0,s.jsxs)("div",{className:`bg-white rounded-lg shadow-md ${a}`,children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white",children:s.jsx("svg",{className:"w-10 h-10",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-2xl font-bold font-mono text-blue-600",children:e.anonymousId}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-600 font-mono",children:["INAMSOS: ",s.jsx("strong",{className:"text-gray-900",children:e.inamsosRecordNumber})]}),e.hospitalRecordNumber&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 font-mono",children:["RM RS: ",e.hospitalRecordNumber]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${{new:"bg-blue-100 text-blue-800",ongoing:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",palliative:"bg-purple-100 text-purple-800",lost_to_followup:"bg-orange-100 text-orange-800",deceased:"bg-red-100 text-red-800"}[e.treatmentStatus]||"bg-gray-100 text-gray-800"}`,children:{new:"Baru",ongoing:"Sedang Berjalan",completed:"Selesai",palliative:"Paliatif",lost_to_followup:"Hilang Follow-up",deceased:"Meninggal"}[n=e.treatmentStatus]||n}),e.isDeceased&&s.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800",children:"Meninggal"})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2 mt-4",children:[s.jsx("button",{onClick:()=>{t?.(e),u(!0)},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"Edit Data"}),!e.isDeceased&&s.jsx("button",{onClick:()=>b(!0),className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"Tandai Meninggal"})]})]}),(0,s.jsxs)("div",{className:"px-6 py-4 bg-gradient-to-r from-blue-50 to-purple-50 border-b border-gray-200",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3 uppercase tracking-wide",children:"Clinical Assessment"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-4 border border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-2xl",children:"\uD83D\uDCC5"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Follow-up Protocol"}),s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Track patient progress with 14-visit longitudinal protocol (5 years)"}),s.jsx("button",{onClick:()=>p.push(`/patients/view/follow-up?id=${e.id}`),className:"w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"View Follow-up Schedule"})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-4 border border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-2xl",children:"\uD83D\uDCCA"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-1",children:"MSTS Score"}),s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Musculoskeletal Tumor Society functional assessment (0-30 points)"}),s.jsx("button",{onClick:()=>p.push(`/patients/view/msts?id=${e.id}`),className:"w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"Calculate MSTS Score"})]})]})})]})]}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Dasar"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tanggal Lahir"}),(0,s.jsxs)("p",{className:"text-gray-900",children:[w(e.dateOfBirth)," (",(e=>{if(!e)return"-";let t=new Date(e),a=new Date,s=a.getFullYear()-t.getFullYear(),r=a.getMonth()-t.getMonth();return r<0||0===r&&a.getDate()<t.getDate()?s-1:s})(e.dateOfBirth)," tahun)"]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Jenis Kelamin"}),s.jsx("p",{className:"text-gray-900",children:"male"===e.gender?"Laki-laki":"Perempuan"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Golongan Darah"}),s.jsx("p",{className:"text-gray-900",children:(o=e.bloodType,c=e.rhFactor,o?`${o}${c?"positive"===c?"+":"-":""}`:"-")})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NIK"}),s.jsx("p",{className:"text-gray-900",children:e.identityNumber||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Telepon"}),s.jsx("p",{className:"text-gray-900",children:e.phone||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),s.jsx("p",{className:"text-gray-900",children:e.email||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pekerjaan"}),s.jsx("p",{className:"text-gray-900",children:e.occupation||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pendidikan"}),s.jsx("p",{className:"text-gray-900",children:e.educationLevel||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status Pernikahan"}),s.jsx("p",{className:"text-gray-900",children:"single"===e.maritalStatus?"Lajang":"married"===e.maritalStatus?"Menikah":"divorced"===e.maritalStatus?"Cerai":"widowed"===e.maritalStatus?"Duda/Janda":"-"})]})]})]}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Alamat"}),s.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,s.jsxs)("p",{className:"text-gray-900",children:[e.address.street&&(0,s.jsxs)(s.Fragment,{children:[e.address.street,", ",s.jsx("br",{})]}),e.address.village&&(0,s.jsxs)(s.Fragment,{children:["Desa ",e.address.village,", ",s.jsx("br",{})]}),e.address.district&&(0,s.jsxs)(s.Fragment,{children:["Kec. ",e.address.district,", ",s.jsx("br",{})]}),e.address.city&&(0,s.jsxs)(s.Fragment,{children:["Kota ",e.address.city,", ",s.jsx("br",{})]}),e.address.province&&(0,s.jsxs)(s.Fragment,{children:["Provinsi ",e.address.province," ",s.jsx("br",{})]}),e.address.postalCode&&(0,s.jsxs)(s.Fragment,{children:[e.address.postalCode,s.jsx("br",{})]}),e.address.country&&s.jsx(s.Fragment,{children:e.address.country})]})})]}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Kontak Darurat"}),s.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nama"}),s.jsx("p",{className:"text-gray-900",children:e.emergencyContact.name})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Hubungan"}),s.jsx("p",{className:"text-gray-900",children:"spouse"===e.emergencyContact.relationship?"Suami/Istri":"parent"===e.emergencyContact.relationship?"Orang Tua":"child"===e.emergencyContact.relationship?"Anak":"sibling"===e.emergencyContact.relationship?"Saudara Kandung":"friend"===e.emergencyContact.relationship?"Teman":"other"===e.emergencyContact.relationship?"Lainnya":"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Telepon"}),s.jsx("p",{className:"text-gray-900",children:e.emergencyContact.phone})]}),e.emergencyContact.address&&(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Alamat"}),s.jsx("p",{className:"text-gray-900",children:e.emergencyContact.address})]})]})})]}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informasi Kanker"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Lokasi Primer"}),s.jsx("p",{className:"text-gray-900",children:e.primaryCancerDiagnosis?.primarySite||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Laterality"}),s.jsx("p",{className:"text-gray-900",children:e.primaryCancerDiagnosis?.laterality==="left"?"Kiri":e.primaryCancerDiagnosis?.laterality==="right"?"Kanan":e.primaryCancerDiagnosis?.laterality==="bilateral"?"Bilateral":e.primaryCancerDiagnosis?.laterality==="midline"?"Midline":e.primaryCancerDiagnosis?.laterality==="unknown"?"Tidak Diketahui":"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Morfologi"}),s.jsx("p",{className:"text-gray-900",children:e.primaryCancerDiagnosis?.morphology||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Perilaku"}),s.jsx("p",{className:"text-gray-900",children:e.primaryCancerDiagnosis?.behavior==="benign"?"Jinak":e.primaryCancerDiagnosis?.behavior==="borderline"?"Batas":e.primaryCancerDiagnosis?.behavior==="invasive"?"Invasif":e.primaryCancerDiagnosis?.behavior==="in_situ"?"In Situ":"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Stadium Kanker"}),s.jsx("p",{className:"text-gray-900",children:e.cancerStage||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Grading"}),s.jsx("p",{className:"text-gray-900",children:e.cancerGrade||"-"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Histologi"}),s.jsx("p",{className:"text-gray-900",children:e.histology||"-"})]})]}),e.tnmClassification&&(0,s.jsxs)("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Klasifikasi TNM"}),(0,s.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg inline-flex space-x-4",children:[(0,s.jsxs)("span",{className:"font-mono",children:["T",e.tnmClassification.t]}),(0,s.jsxs)("span",{className:"font-mono",children:["N",e.tnmClassification.n]}),(0,s.jsxs)("span",{className:"font-mono",children:["M",e.tnmClassification.m]})]})]}),e.molecularMarkers&&e.molecularMarkers.length>0&&(0,s.jsxs)("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Marker Molekuler"}),s.jsx("div",{className:"space-y-2",children:e.molecularMarkers.map((e,t)=>(0,s.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-medium",children:e.name}),s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${"positive"===e.result?"bg-green-100 text-green-800":"negative"===e.result?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:"positive"===e.result?"Positif":"negative"===e.result?"Negatif":"Tidak Diketahui"})]}),e.testDate&&(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Tes: ",w(e.testDate)]}),e.methodology&&(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Metode: ",e.methodology]})]},t))})]})]}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informasi Pengobatan"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tanggal Diagnosis"}),s.jsx("p",{className:"text-gray-900",children:w(e.dateOfDiagnosis)})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Kunjungan Pertama"}),s.jsx("p",{className:"text-gray-900",children:w(e.dateOfFirstVisit)})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pusat Pengobatan"}),s.jsx("p",{className:"text-gray-900",children:e.treatmentCenter})]}),e.treatmentCenterName&&(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nama Pusat"}),s.jsx("p",{className:"text-gray-900",children:e.treatmentCenterName})]}),e.lastVisitDate&&(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Kunjungan Terakhir"}),s.jsx("p",{className:"text-gray-900",children:w(e.lastVisitDate)})]})]})]}),e.isDeceased&&(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-red-900 mb-2",children:"Informasi Kematian"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-red-700",children:"Tanggal Meninggal"}),s.jsx("p",{className:"text-red-900",children:w(e.dateOfDeath||"")})]}),e.causeOfDeath&&(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-red-700",children:"Sebab Kematian"}),s.jsx("p",{className:"text-red-900",children:e.causeOfDeath})]})]})]}),(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informasi Sistem"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Dibuat Oleh"}),s.jsx("p",{className:"text-gray-900",children:e.createdBy})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tanggal Dibuat"}),s.jsx("p",{className:"text-gray-900",children:w(e.createdAt)})]}),e.updatedBy&&(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Diperbarui Oleh"}),s.jsx("p",{className:"text-gray-900",children:e.updatedBy})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Terakhir Diperbarui"}),s.jsx("p",{className:"text-gray-900",children:w(e.updatedAt)})]})]})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[s.jsx("div",{className:"border-b border-gray-200",children:(0,s.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[s.jsx("button",{onClick:()=>f("info"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"info"===j?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Patient Info"}),s.jsx("button",{onClick:()=>f("photos"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"photos"===j?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"\uD83D\uDCF8 Clinical Photos"}),s.jsx("button",{onClick:()=>f("radiology"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"radiology"===j?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"\uD83C\uDFE5 Radiology"}),s.jsx("button",{onClick:()=>f("pathology"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"pathology"===j?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"\uD83D\uDD2C Pathology"})]})}),(0,s.jsxs)("div",{className:"mt-6",children:["info"===j&&s.jsx("div",{className:"text-sm text-gray-600 bg-blue-50 p-4 rounded-lg",children:s.jsx("p",{children:"ℹ️ All patient information is displayed above. Use the tabs to view clinical photos, radiology images, and pathology reports. Use the Clinical Assessment section above to access follow-up schedule and MSTS functional assessment."})}),"photos"===j&&s.jsx(d,{patientId:e.id,patientName:e.name||e.anonymousId}),"radiology"===j&&s.jsx(m,{patientId:e.id,patientName:e.name||e.anonymousId}),"pathology"===j&&s.jsx(x,{patientId:e.id,patientName:e.name||e.anonymousId})]})]})]}),y&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Tandai Pasien Meninggal"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tanggal Meninggal *"}),s.jsx("input",{type:"date",value:N.dateOfDeath,onChange:e=>v(t=>({...t,dateOfDeath:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sebab Kematian"}),s.jsx("textarea",{value:N.causeOfDeath,onChange:e=>v(t=>({...t,causeOfDeath:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Sebab kematian (opsional)"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 mt-6",children:[s.jsx("button",{onClick:()=>{b(!1),v({dateOfDeath:"",causeOfDeath:""})},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Batal"}),s.jsx("button",{onClick:S,disabled:!N.dateOfDeath,className:"bg-red-500 hover:bg-red-600 disabled:bg-red-300 text-white px-4 py-2 rounded-lg",children:"Simpan"})]})]})})]})}var g=a(9356);function h(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)().get("id"),{setCurrentPatient:a}=(0,l.l)(),[n,o]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0),[m,x]=(0,r.useState)("");(0,r.useEffect)(()=>{t?h():e.push("/patients")},[t]);let h=async()=>{if(t)try{c(!0);let e=await g.ZP.getById(t);o(e),a(e)}catch(e){x(e.message||"Failed to load patient")}finally{c(!1)}};return d?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading patient data..."})]})}):t&&(m||!n)?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"text-6xl mb-4",children:"⚠️"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Patient Not Found"}),s.jsx("p",{className:"text-gray-600 mb-6",children:m||"Unable to load patient data"}),s.jsx("button",{onClick:()=>e.push("/patients"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700",children:"Back to Patients"})]})}):n?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:[s.jsx("div",{className:"max-w-7xl mx-auto mb-6",children:(0,s.jsxs)("button",{onClick:()=>e.push("/patients"),className:"flex items-center text-blue-600 hover:text-blue-800 font-medium mb-4",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Kembali ke Daftar Pasien"]})}),s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx(p,{patient:n,onEdit:e=>console.log("Edit patient:",e)})})]}):null}function u(){return s.jsx(n.A,{children:s.jsx(l.S,{children:s.jsx(r.Suspense,{fallback:s.jsx("div",{children:"Loading..."}),children:s.jsx(h,{})})})})}},5321:(e,t,a)=>{"use strict";a.d(t,{S:()=>d,l:()=>c});var s=a(2295),r=a(3729);let i={patients:[],currentPatient:null,isLoading:!1,error:null,searchQuery:{page:1,limit:10,sortBy:"createdAt",sortOrder:"desc"},statistics:null};function l(e,t){switch(t.type){case"SET_LOADING":return{...e,isLoading:t.payload};case"SET_ERROR":return{...e,error:t.payload,isLoading:!1};case"SET_PATIENTS":return{...e,patients:t.payload,isLoading:!1};case"SET_CURRENT_PATIENT":return{...e,currentPatient:t.payload,isLoading:!1};case"SET_SEARCH_QUERY":return{...e,searchQuery:{...e.searchQuery,...t.payload}};case"SET_STATISTICS":return{...e,statistics:t.payload,isLoading:!1};case"ADD_PATIENT":return{...e,patients:[t.payload,...e.patients]};case"UPDATE_PATIENT":return{...e,patients:e.patients.map(e=>e.id===t.payload.id?t.payload:e),currentPatient:e.currentPatient?.id===t.payload.id?t.payload:e.currentPatient};case"REMOVE_PATIENT":return{...e,patients:e.patients.filter(e=>e.id!==t.payload),currentPatient:e.currentPatient?.id===t.payload?null:e.currentPatient};case"APPEND_PATIENTS":return{...e,patients:[...e.patients,...t.payload],isLoading:!1};default:return e}}let n=(0,r.createContext)(void 0);async function o(e,t={}){let a=localStorage.getItem("token"),s=await fetch(`http://127.0.0.1:3001/api${e}`,{headers:{"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`},...t.headers},...t});if(!s.ok)throw Error((await s.json().catch(()=>({message:"Network error"}))).message||`HTTP ${s.status}: ${s.statusText}`);return s.json()}function d({children:e}){let[t,a]=(0,r.useReducer)(l,i),d=async e=>{try{a({type:"SET_LOADING",payload:!0}),a({type:"SET_ERROR",payload:null});let s=new URLSearchParams,r={...t.searchQuery,...e};Object.entries(r).forEach(([e,t])=>{null!=t&&""!==t&&s.append(e,String(t))});let i=await o(`/patients?${s.toString()}`);a({type:"SET_PATIENTS",payload:i.patients})}catch(e){a({type:"SET_ERROR",payload:e instanceof Error?e.message:"Failed to fetch patients"})}},c=async()=>{try{if(t.isLoading)return;a({type:"SET_LOADING",payload:!0});let e=(t.searchQuery.page||1)+1,s=new URLSearchParams,r={...t.searchQuery,page:e};Object.entries(r).forEach(([e,t])=>{null!=t&&""!==t&&s.append(e,String(t))});let i=await o(`/patients?${s.toString()}`);i.patients.length>0?(a({type:"APPEND_PATIENTS",payload:i.patients}),a({type:"SET_SEARCH_QUERY",payload:{page:e}})):a({type:"SET_LOADING",payload:!1})}catch(e){a({type:"SET_ERROR",payload:e instanceof Error?e.message:"Failed to load more patients"})}},m=async e=>{try{a({type:"SET_LOADING",payload:!0});let t=await o("/patients",{method:"POST",body:JSON.stringify(e)});return a({type:"ADD_PATIENT",payload:t}),t}catch(s){console.warn("API not available, patient data logged to console:",s);let t={id:`patient-${Date.now()}`,...e,isActive:!0,isDeceased:!1,createdBy:"current-user",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return console.log("✅ Mock patient created:",t),a({type:"ADD_PATIENT",payload:t}),a({type:"SET_LOADING",payload:!1}),t}},x=async(e,t)=>{try{a({type:"SET_LOADING",payload:!0});let s=await o(`/patients/${e}`,{method:"PATCH",body:JSON.stringify(t)});return a({type:"UPDATE_PATIENT",payload:s}),s}catch(e){throw a({type:"SET_ERROR",payload:e instanceof Error?e.message:"Failed to update patient"}),e}},p=async e=>{try{a({type:"SET_LOADING",payload:!0}),await o(`/patients/${e}/soft-delete`,{method:"PATCH"}),a({type:"REMOVE_PATIENT",payload:e})}catch(e){throw a({type:"SET_ERROR",payload:e instanceof Error?e.message:"Failed to delete patient"}),e}},g=async e=>{try{a({type:"SET_LOADING",payload:!0}),a({type:"SET_ERROR",payload:null});let t=new URLSearchParams;return Object.entries(e).forEach(([e,a])=>{null!=a&&""!==a&&t.append(e,String(a))}),await o(`/patients?${t.toString()}`)}catch(e){throw a({type:"SET_ERROR",payload:e instanceof Error?e.message:"Failed to search patients"}),e}},h=async e=>{try{a({type:"SET_LOADING",payload:!0});let t=await o(`/patients/${e}`);return a({type:"SET_CURRENT_PATIENT",payload:t}),t}catch(e){throw a({type:"SET_ERROR",payload:e instanceof Error?e.message:"Failed to fetch patient"}),e}},u=async()=>{try{a({type:"SET_LOADING",payload:!0});let e=await o("/patients/statistics");a({type:"SET_STATISTICS",payload:e})}catch(e){a({type:"SET_ERROR",payload:e instanceof Error?e.message:"Failed to fetch statistics"})}},y=async e=>{try{a({type:"SET_LOADING",payload:!0});let t=await o("/patients/quick-entry",{method:"POST",body:JSON.stringify(e)});return a({type:"ADD_PATIENT",payload:t}),t}catch(e){throw a({type:"SET_ERROR",payload:e instanceof Error?e.message:"Failed to create patient"}),e}},b=async()=>{try{return await o("/patients/chat/session",{method:"POST",body:JSON.stringify({})})}catch(t){console.warn("API not available, using mock session:",t);let e={id:`session-${Date.now()}`,status:"in_progress",currentStep:0,totalSteps:8,messages:[{id:"1",type:"system",content:"\uD83D\uDC4B Selamat datang di sistem INAMSOS! Saya akan membantu Anda memasukkan data pasien kanker baru.",timestamp:new Date().toISOString()},{id:"2",type:"form",content:"Mari kita mulai! Siapa nama lengkap pasien?",timestamp:new Date().toISOString()}],formData:{},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:"current-user"};return window.__mockChatSession=e,e}},j=async(e,t,a,s)=>{try{return await o(`/patients/chat/${e}/message`,{method:"POST",body:JSON.stringify({content:t,fieldName:a,formData:s})})}catch(d){let e;console.warn("API not available, using mock message handling:",d);let a=window.__mockChatSession;if(!a)throw Error("Session not found");let r={id:`${Date.now()}-user`,type:"user",content:t,timestamp:new Date().toISOString()},i={...a.formData,...s},l=a.currentStep+1,n=["name","dateOfBirth","gender","phone","address","primarySite","cancerStage","treatmentStatus"];e=l<n.length?{id:`${Date.now()}-system`,type:"system",content:({dateOfBirth:"Kapan tanggal lahir pasien? (Format: YYYY-MM-DD)",gender:"Jenis kelamin pasien?",phone:"Nomor telepon yang bisa dihubungi? (Opsional, tekan Enter untuk skip)",address:"Alamat lengkap pasien?",primarySite:"Dimana lokasi kanker primer?",cancerStage:"Stadium kanker?",treatmentStatus:"Status pengobatan saat ini?"})[n[l]]||"Lanjut...",timestamp:new Date().toISOString()}:{id:`${Date.now()}-system`,type:"system",content:"✅ Data lengkap! Menyimpan data pasien...",timestamp:new Date().toISOString(),completed:!0};let o={...a,currentStep:l,messages:[...a.messages,r,e],formData:i,status:l>=n.length?"completed":"in_progress",updatedAt:new Date().toISOString()};return window.__mockChatSession=o,o}},f=async e=>{try{return await o(`/patients/chat/${e}`)}catch(e){throw a({type:"SET_ERROR",payload:e instanceof Error?e.message:"Failed to get chat session"}),e}};(0,r.useEffect)(()=>{d()},[]);let N={...t,setPatients:e=>a({type:"SET_PATIENTS",payload:e}),setCurrentPatient:e=>a({type:"SET_CURRENT_PATIENT",payload:e}),setLoading:e=>a({type:"SET_LOADING",payload:e}),setError:e=>a({type:"SET_ERROR",payload:e}),setSearchQuery:e=>a({type:"SET_SEARCH_QUERY",payload:e}),clearCurrentPatient:()=>a({type:"SET_CURRENT_PATIENT",payload:null}),fetchPatients:d,createPatient:m,updatePatient:x,deletePatient:p,searchPatients:g,getPatientById:h,getStatistics:u,quickEntry:y,createChatSession:b,sendChatMessage:j,getChatSession:f,loadMorePatients:c};return s.jsx(n.Provider,{value:N,children:e})}function c(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("usePatient must be used within a PatientProvider");return e}},5923:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var s=a(7530);class r{async uploadPhoto(e){let t=new FormData;return t.append("file",e.file),t.append("patientId",e.patientId),e.viewType&&t.append("viewType",e.viewType),e.anatomicalLocation&&t.append("anatomicalLocation",e.anatomicalLocation),e.description&&t.append("description",e.description),(await s.Z.post("/clinical-photos/upload",t,{headers:{"Content-Type":"multipart/form-data"}})).data}async uploadMultiplePhotos(e,t){let a=t.map(t=>this.uploadPhoto({patientId:e,file:t.file,viewType:t.viewAngle,description:t.description}));return await Promise.all(a)}async getPhotosByPatient(e){return(await s.Z.get(`/clinical-photos/patient/${e}`)).data}async deletePhoto(e){return(await s.Z.delete(`/clinical-photos/${e}`)).data}}let i=new r},6735:(e,t,a)=>{"use strict";a.d(t,{US:()=>r,ZP:()=>n,cL:()=>s});var s,r,i=a(7530);(function(e){e.HISTOLOGY="HISTOLOGY",e.RADIOLOGY="RADIOLOGY",e.CLINICAL_PHOTO="CLINICAL_PHOTO",e.PATHOLOGY="PATHOLOGY",e.ENDOSCOPY="ENDOSCOPY",e.ULTRASOUND="ULTRASOUND",e.CT_SCAN="CT_SCAN",e.MRI="MRI",e.XRAY="XRAY",e.PET_SCAN="PET_SCAN",e.MAMMOGRAPHY="MAMMOGRAPHY",e.OTHER="OTHER"})(s||(s={})),function(e){e.HISTOLOGY="HISTOLOGY",e.RADIOLOGY="RADIOLOGY",e.CLINICAL="CLINICAL",e.PATHOLOGY="PATHOLOGY",e.DIAGNOSTIC="DIAGNOSTIC",e.SURGICAL="SURGICAL",e.FOLLOW_UP="FOLLOW_UP",e.SCREENING="SCREENING",e.OTHER="OTHER"}(r||(r={}));class l{async uploadImage(e,t,a){let s=new FormData;return s.append("file",e),Object.entries(t).forEach(([e,t])=>{null!=t&&("object"==typeof t?s.append(e,JSON.stringify(t)):s.append(e,String(t)))}),(await i.Z.post("/medical-imaging/upload",s,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{a&&e.total&&a(Math.round(100*e.loaded/e.total))}})).data}async getAllImages(e){return(await i.Z.get("/medical-imaging",{params:e})).data}async getImageById(e){return(await i.Z.get(`/medical-imaging/${e}`)).data}async getImagesByPatient(e){return(await i.Z.get(`/medical-imaging/patient/${e}`)).data}async downloadImage(e){return(await i.Z.get(`/medical-imaging/${e}/download`,{responseType:"blob"})).data}getThumbnailUrl(e){return`${i.Z.defaults.baseURL}/medical-imaging/${e}/thumbnail`}getImageUrl(e){return`${i.Z.defaults.baseURL}/medical-imaging/${e}/download`}async updateImage(e,t){return(await i.Z.put(`/medical-imaging/${e}`,t)).data}async deleteImage(e){await i.Z.delete(`/medical-imaging/${e}`)}isValidImageFile(e){return["image/jpeg","image/jpg","image/png","image/gif","image/bmp","image/tiff","application/dicom","image/dicom"].includes(e.type)}formatFileSize(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]}}let n=new l},9356:(e,t,a)=>{"use strict";async function s(e,t={}){let a={"Content-Type":"application/json",...t.headers},s=await fetch(`http://127.0.0.1:3001/api${e}`,{...t,headers:a});if(!s.ok){if(401===s.status)throw Error("Session expired. Please login again.");let e=await s.json().catch(()=>({message:`HTTP ${s.status}: ${s.statusText}`}));if(400===s.status&&e.error?.details?.some(e=>"Unauthorized"===e.message))throw Error("Session expired. Please login again.");throw Error(e.message||"API request failed")}return s.json()}async function r(e){let t=new URLSearchParams;return e?.page&&t.append("page",e.page.toString()),e?.limit&&t.append("limit",e.limit.toString()),e?.search&&t.append("search",e.search),e?.centerId&&t.append("centerId",e.centerId),s(`/patients?${t.toString()}`)}a.d(t,{X4:()=>r,ZP:()=>i});let i={create:async function(e){return s("/patients",{method:"POST",body:JSON.stringify(e)})},update:async function(e,t){return s(`/patients/${e}`,{method:"PATCH",body:JSON.stringify(t)})},getById:async function(e){return s(`/patients/${e}`)},getAll:r,delete:async function(e){return s(`/patients/${e}`,{method:"DELETE"})},transformWizardData:function(e){let t=e.section1||{},a=e.section2||{},s=e.section3||{},r=e.section4||{},i=e.section5||{},l=e.section6||{},n=e.section7||{},o=e.section8||{},d=e.section9||{};return{centerId:t.centerId||"",pathologyType:t.pathologyTypeId,hospitalRecordNumber:a.hospitalRecordNumber||`MR-${Date.now()}`,nik:a.nik||"",name:a.name||"",dateOfBirth:a.dateOfBirth||"",placeOfBirth:a.placeOfBirth,gender:a.gender||"",bloodType:a.bloodType,religion:a.religion,maritalStatus:a.maritalStatus,occupation:a.occupation,education:a.education,phone:a.phone,email:a.email,address:a.address,province:a.province,regency:a.regency,district:a.district,village:a.village,postalCode:a.postalCode,emergencyContact:a.emergencyContact,chiefComplaint:s.chiefComplaint,symptomOnset:s.symptomOnset,symptomDuration:s.symptomDuration,symptomDurationUnit:s.symptomDurationUnit,presentingSymptoms:s.presentingSymptoms,tumorSize:s.tumorSize,familyHistory:s.familyHistory,tumorSyndromeId:s.tumorSyndromeId,karnofskyScore:s.karnofskyScore,height:s.height,weight:s.weight,bmi:s.bmi,biopsyType:r.biopsyType,biopsyDate:r.biopsyDate,biopsyLocation:r.biopsyLocation,biopsySite:r.biopsySite,imagingStudies:r.imagingStudies,imagingDate:r.imagingDate,imagingFindings:r.imagingFindings,mirrelScore:r.mirrelScore,diagnosisDate:i.diagnosisDate,whoClassificationId:i.whoClassificationId,boneLocationId:i.boneLocationId,softTissueLocationId:i.softTissueLocationId,tumorGrade:i.tumorGrade,histopathology:i.histopathology,stagingSystem:l.stagingSystem,enneking:l.enneking,ajcc:l.ajcc,cpc:n.cpcHeld?{held:n.cpcHeld,date:n.cpcDate,location:n.cpcLocation,participants:n.participants,presentation:n.casePresentation,recommendations:n.recommendations,consensus:n.consensus,notes:n.notes}:void 0,treatment:{surgery:o.surgery,chemotherapy:o.chemotherapy,radiotherapy:o.radiotherapy,overallResponse:o.overallResponse},followUp:{visits:d.visits}}}}},8717:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>i,__esModule:()=>r,default:()=>l});let s=(0,a(6843).createProxy)(String.raw`D:\Project\Tumor Registry\INAMSOS Application Desktop\frontend\src\app\patients\view\page.tsx`),{__esModule:r,$$typeof:i}=s,l=s.default}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[7141,4192,4573],()=>a(1148));module.exports=s})();