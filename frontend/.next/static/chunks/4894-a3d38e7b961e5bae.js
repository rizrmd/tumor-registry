"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4894],{4894:function(e,s,t){t.d(s,{A:function(){return x}});var r=t(7437),n=t(2265),a=t(4033),l=t(6986),i=t(1396),c=t.n(i),o=t(7301);function d(){let{statistics:e,fullSyncStatus:s,isSyncing:t,syncProgress:a,lastSyncedAt:l,error:i,triggerFullSync:d}=(0,o.useSync)(),[u,m]=(0,n.useState)(!1),x=(0,n.useRef)(null);if((0,n.useEffect)(()=>{function e(e){x.current&&!x.current.contains(e.target)&&m(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),!e)return null;let h=e.failed>0,f=e.conflict>0,N=e.pending>0||e.processing>0;e.needsAttention;let g="bg-emerald-500",p="Synced",E="animate-blink-slow",y=(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});return t?(g="bg-blue-500",p="Syncing...",E="animate-blink-fast",y=(0,r.jsx)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})):f?(g="bg-red-600",p="Conflicts",E="animate-blink-fast",y=(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})):h?(g="bg-red-500",p="Failed Items",E="animate-blink-slow",y=(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})):N&&(g="bg-yellow-500",p="Unsynced",E="",y=(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})),(0,r.jsxs)("div",{className:"relative",ref:x,children:[(0,r.jsxs)("button",{onClick:()=>m(!u),className:"flex items-center space-x-2 px-3 py-1.5 rounded-full border border-gray-200 hover:bg-gray-50 transition-colors bg-white shadow-sm",title:"Sync Status: ".concat(p),children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(g," ").concat(E)}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700 hidden sm:inline",children:p}),y]}),u&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-gray-100 z-50 overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-50 bg-gray-50/50",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Sync Details"}),l&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:["Last synced: ",l.toLocaleTimeString()]})]}),(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[t&&(0,r.jsxs)("div",{className:"p-3 rounded-lg bg-blue-50 border border-blue-100",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-xs font-semibold text-blue-700",children:(e=>{switch(e){case"idle":return"Idle";case"push":return"Uploading data...";case"pull":return"Downloading data...";case"files":return"Syncing files...";case"complete":return"Complete";case"error":return"Error";default:return"Unknown"}})(a.phase)}),(0,r.jsxs)("span",{className:"text-xs font-medium text-blue-600",children:[a.phaseProgress,"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-blue-200 rounded-full h-2 mb-2",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(a.phaseProgress,"%")}})}),a.currentFile&&(0,r.jsx)("p",{className:"text-xs text-blue-600 truncate",children:a.currentFile.split("/").pop()}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 mt-2 text-xs",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-blue-500",children:"Data Pushed:"}),(0,r.jsx)("span",{className:"font-semibold text-blue-700 ml-1",children:a.dataPushed})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-blue-500",children:"Data Pulled:"}),(0,r.jsx)("span",{className:"font-semibold text-blue-700 ml-1",children:a.dataPulled})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-blue-500",children:"Files:"}),(0,r.jsxs)("span",{className:"font-semibold text-blue-700 ml-1",children:[a.filesSynced,"/",a.totalFiles]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Data Sync"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"p-2.5 rounded-lg bg-gray-50 border border-gray-100",children:[(0,r.jsx)("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Synced"}),(0,r.jsx)("p",{className:"text-xl font-bold text-emerald-600",children:e.synced})]}),(0,r.jsxs)("div",{className:"p-2.5 rounded-lg bg-gray-50 border border-gray-100",children:[(0,r.jsx)("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Pending"}),(0,r.jsx)("p",{className:"text-xl font-bold text-yellow-600",children:e.pending})]}),(0,r.jsxs)(c(),{href:"/sync/conflicts",className:"p-2.5 rounded-lg bg-orange-50 border border-orange-200 hover:bg-orange-100 transition-colors cursor-pointer block",onClick:()=>m(!1),children:[(0,r.jsx)("p",{className:"text-[10px] font-bold text-orange-400 uppercase tracking-wider",children:"Conflicts"}),(0,r.jsx)("p",{className:"text-xl font-bold text-orange-600",children:e.conflict})]}),(0,r.jsxs)(c(),{href:"/sync/conflicts",className:"p-2.5 rounded-lg bg-red-50 border border-red-200 hover:bg-red-100 transition-colors cursor-pointer block",onClick:()=>m(!1),children:[(0,r.jsx)("p",{className:"text-[10px] font-bold text-red-400 uppercase tracking-wider",children:"Failed"}),(0,r.jsx)("p",{className:"text-xl font-bold text-red-600",children:e.failed})]})]})]}),(null==s?void 0:s.fileSync)&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"File Sync"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"p-2.5 rounded-lg bg-gray-50 border border-gray-100",children:[(0,r.jsx)("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Pending"}),(0,r.jsx)("p",{className:"text-xl font-bold text-yellow-600",children:s.fileSync.pending})]}),(0,r.jsxs)("div",{className:"p-2.5 rounded-lg bg-gray-50 border border-gray-100",children:[(0,r.jsx)("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"In Progress"}),(0,r.jsx)("p",{className:"text-xl font-bold text-blue-600",children:s.fileSync.inProgress})]}),(0,r.jsxs)("div",{className:"p-2.5 rounded-lg bg-gray-50 border border-gray-100",children:[(0,r.jsx)("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Completed"}),(0,r.jsx)("p",{className:"text-xl font-bold text-emerald-600",children:s.fileSync.completed})]}),(0,r.jsxs)("div",{className:"p-2.5 rounded-lg bg-gray-50 border border-gray-100",children:[(0,r.jsx)("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Total Size"}),(0,r.jsx)("p",{className:"text-sm font-bold text-gray-700",children:(e=>{if(0===e)return"0 B";let s=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,s)*100)/100+" "+["B","KB","MB","GB"][s]})(s.fileSync.totalSize)})]})]})]}),(0,r.jsx)("button",{onClick:()=>{d(),m(!1)},disabled:t,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 rounded-lg text-sm font-semibold transition-all shadow-sm ".concat(t?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-emerald-600 text-white hover:bg-emerald-700 active:scale-[0.98]"),children:t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-3.5 h-3.5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Syncing..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,r.jsx)("span",{children:"Sync Now (Data + Files)"})]})})]}),(0,r.jsx)("div",{className:"p-3 bg-gray-50/50 border-t border-gray-50",children:(0,r.jsx)(c(),{href:"/sync/conflicts",className:"text-xs text-emerald-600 font-medium hover:text-emerald-700 block text-center",onClick:()=>m(!1),children:"Manage Sync Conflicts & Issues"})})]})]})}var u=t(7841),m=t(5925);function x(e){var s,t,i;let{children:c}=e,{user:o,logout:x,isLoading:h}=(0,l.useAuth)(),f=(0,a.useRouter)(),N=(0,a.usePathname)(),[g,p]=(0,n.useState)(!1),[E,y]=(0,n.useState)(!1),[b,A]=(0,n.useState)([]),[j,v]=(0,n.useState)(!1),[D,_]=(0,n.useState)(!1),S=async()=>{try{await x(),f.push("/login")}catch(e){console.error("Logout failed:",e)}},M=[{name:"Dashboard",href:"/dashboard",icon:"\uD83D\uDCCA"},{name:"Data Pasien",href:"/patients",icon:"\uD83D\uDC65",roles:["DATA_ENTRY","MEDICAL_OFFICER","RESEARCHER","CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER","OBSERVER"],submenu:[{name:"Daftar Pasien",href:"/patients",roles:["DATA_ENTRY","MEDICAL_OFFICER","RESEARCHER","CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER","OBSERVER"]},{name:"Entry Data Baru",href:"/patients/new",roles:["DATA_ENTRY","MEDICAL_OFFICER","CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER"]}]},{name:"Follow-up & MSTS",href:"/follow-up",icon:"\uD83D\uDCC5",roles:["DATA_ENTRY","MEDICAL_OFFICER","CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER","OBSERVER"],submenu:[{name:"14-Visit Protocol",href:"/follow-up",roles:["DATA_ENTRY","MEDICAL_OFFICER","CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER","OBSERVER"]},{name:"MSTS Calculator",href:"/msts",roles:["DATA_ENTRY","MEDICAL_OFFICER","CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER","OBSERVER"]},{name:"Compliance Tracking",href:"/follow-up/compliance",roles:["CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER"]},{name:"Reminder Management",href:"/follow-up/reminders",roles:["DATA_ENTRY","MEDICAL_OFFICER","CENTER_ADMIN","HEAD_OF_CENTER"]}]},{name:"Penelitian",href:"/research",icon:"\uD83D\uDD2C",roles:["RESEARCHER","CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER","OBSERVER","DATA_ENTRY"],submenu:[{name:"Browse Data",href:"/research",roles:["RESEARCHER","CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER","OBSERVER","DATA_ENTRY"]},{name:"Laporan",href:"/reports",roles:["RESEARCHER","CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER","OBSERVER","DATA_ENTRY"]},{name:"Permintaan Data",href:"/research/requests",roles:["RESEARCHER","CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER"]}]},{name:"Persetujuan",href:"/approvals",icon:"✅",roles:["CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER"],submenu:[{name:"Antrian Permintaan",href:"/approvals",roles:["CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER"]},{name:"Riwayat Persetujuan",href:"/approvals/history",roles:["CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER"]}]},{name:"Analytics",href:"/analytics",icon:"\uD83D\uDCC8",roles:["DATA_ENTRY","MEDICAL_OFFICER","RESEARCHER","CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER","OBSERVER"]},{name:"Administrasi",href:"/admin",icon:"⚙️",roles:["CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER"],submenu:[{name:"User Management",href:"/admin/users",roles:["CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER"]},{name:"Center Management",href:"/admin/centers",roles:["NATIONAL_ADMIN","SYSTEM_ADMIN"]},{name:"Audit Logs",href:"/admin/audit",roles:["CENTER_ADMIN","NATIONAL_ADMIN","SYSTEM_ADMIN","HEAD_OF_CENTER"]},{name:"Konfigurasi",href:"/admin/config",roles:["NATIONAL_ADMIN","SYSTEM_ADMIN"]}]},{name:"Pengaturan",href:"/settings",icon:"\uD83D\uDD27"}],w=M.filter(e=>!e.roles||(null==o?void 0:o.role)&&e.roles.includes(o.role)),R=e=>{A(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},C=e=>e.href===N||!!e.submenu&&e.submenu.some(e=>e.href===N);return n.useEffect(()=>{let e=M.find(e=>!!e.submenu&&e.submenu.some(e=>e.href===N));e&&!b.includes(e.name)&&A(s=>[...s,e.name]),_(!0)},[N]),(0,n.useEffect)(()=>{let e=()=>{console.log("Network online detected. Starting sync..."),m.ZP.promise(u.Rb.runFullSync(),{loading:"Connection restored. Syncing data...",success:"Data synchronized successfully",error:"Sync failed (will retry later)"})};window.addEventListener("online",e),"undefined"!=typeof navigator&&navigator.onLine;let s=setInterval(()=>{"undefined"!=typeof navigator&&navigator.onLine&&(console.log("Running scheduled sync..."),u.Rb.runFullSync().catch(e=>console.error("Scheduled sync failed",e)))},3e5);return()=>{window.removeEventListener("online",e),clearInterval(s)}},[]),(0,r.jsxs)("div",{className:"flex h-screen overflow-hidden bg-gray-50",children:[j&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 bg-gray-900 bg-opacity-50 flex items-center justify-center",children:(0,r.jsx)("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"}),(0,r.jsx)("span",{className:"text-gray-700 font-medium",children:"Loading..."})]})})}),g&&(0,r.jsx)("div",{className:"fixed inset-0 z-40 bg-gray-600 bg-opacity-75 lg:hidden",onClick:()=>p(!1)}),(0,r.jsx)("div",{className:"fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-200 ease-in-out lg:relative lg:translate-x-0 ".concat(g?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsx)("div",{className:"flex items-center justify-center h-16 px-4 bg-emerald-600 border-b border-emerald-700",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-white rounded-lg flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-emerald-600 font-bold text-lg",children:"I"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-white font-bold text-lg",children:"INAMSOS"}),(0,r.jsx)("p",{className:"text-emerald-100 text-xs",children:"Musculoskeletal Tumor Registry"})]})]})}),(0,r.jsx)("nav",{className:"flex-1 px-4 py-6 space-y-1 overflow-y-auto",children:h?(0,r.jsx)("div",{className:"space-y-3 animate-pulse",children:[1,2,3,4,5,6].map(e=>(0,r.jsxs)("div",{className:"flex items-center px-3 py-2 space-x-3",children:[(0,r.jsx)("div",{className:"w-6 h-6 bg-gray-200 rounded"}),(0,r.jsx)("div",{className:"h-4 bg-gray-100 rounded w-24"})]},e))}):w.map(e=>{let s=C(e),t=e.submenu&&e.submenu.length>0,n=b.includes(e.name);return(0,r.jsxs)("div",{children:[t?(0,r.jsxs)("button",{onClick:()=>R(e.name),className:"w-full flex items-center justify-between px-3 py-2 text-sm font-medium rounded-lg group ".concat(s?"bg-emerald-100 text-emerald-700":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"),children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-3 text-lg",children:e.icon}),e.name]}),(0,r.jsx)("svg",{className:"w-4 h-4 transition-transform ".concat(n?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}):(0,r.jsxs)("a",{href:e.href,className:"flex items-center px-3 py-2 text-sm font-medium rounded-lg group ".concat(s?"bg-emerald-100 text-emerald-700":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"),onClick:()=>p(!1),children:[(0,r.jsx)("span",{className:"mr-3 text-lg",children:e.icon}),e.name]}),t&&n&&(0,r.jsx)("div",{className:"ml-6 mt-1 space-y-1",children:e.submenu.filter(e=>!e.roles||(null==o?void 0:o.role)&&e.roles.includes(o.role)).map(e=>{let s=N===e.href;return(0,r.jsx)("a",{href:e.href,className:"flex items-center px-3 py-2 text-sm rounded-lg ".concat(s?"bg-emerald-50 text-emerald-700 font-medium":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),onClick:()=>p(!1),children:e.name},e.name)})})]},e.name)})}),(0,r.jsx)("div",{className:"border-t border-gray-200 p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-emerald-600 text-sm font-medium",children:null==o?void 0:null===(s=o.name)||void 0===s?void 0:s.charAt(0).toUpperCase()})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:null==o?void 0:o.name}),(0,r.jsx)("p",{className:"text-xs text-gray-500 truncate",children:(null==o?void 0:o.role)&&(({data_entry:"Data Entry",doctor:"Dokter",nurse:"Perawat",researcher:"Peneliti",admin:"Administrator",super_admin:"Super Admin",national_stakeholder:"Stakeholder Nasional",SYSTEM_ADMIN:"System Administrator",NATIONAL_ADMIN:"National Administrator",CENTER_ADMIN:"Center Administrator",RESEARCHER:"Researcher",DATA_ENTRY:"Data Entry",MEDICAL_OFFICER:"Medical Officer",HEAD_OF_CENTER:"Kepala Center",OBSERVER:"Observer"})[i=o.role]||i)}),(null==o?void 0:o.centerName)&&(0,r.jsx)("p",{className:"text-xs text-gray-500 truncate",children:o.centerName})]})]})})]})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col lg:pl-0",children:[(0,r.jsx)("div",{className:"sticky top-0 z-40 bg-white shadow-sm border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8",children:[(0,r.jsx)("div",{className:"flex items-center lg:hidden",children:(0,r.jsx)("button",{type:"button",className:"text-gray-500 hover:text-gray-600 focus:outline-none focus:text-gray-600",onClick:()=>p(!g),children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),(0,r.jsx)("div",{className:"flex-1 flex items-center justify-between",children:(0,r.jsx)("div",{className:"max-w-lg",children:(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:(()=>{let e=M.find(e=>e.href===N);if(e)return e.name;for(let e of M)if(e.submenu){let s=e.submenu.find(e=>e.href===N);if(s)return s.name}return"Dashboard"})()})})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(d,{}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{type:"button",className:"flex items-center space-x-3 text-sm rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 p-2",onClick:()=>y(!E),children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-emerald-600 text-sm font-medium",children:null==o?void 0:null===(t=o.name)||void 0===t?void 0:t.charAt(0).toUpperCase()})}),(0,r.jsx)("span",{className:"hidden md:block text-sm font-medium text-gray-700",children:null==o?void 0:o.name}),(0,r.jsx)("svg",{className:"hidden md:block h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),E&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-1 z-50 border border-gray-200",children:[(0,r.jsx)("a",{href:"/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>y(!1),children:"Profil Saya"}),(0,r.jsx)("a",{href:"/settings",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>y(!1),children:"Pengaturan"}),(0,r.jsx)("hr",{className:"my-1 border-gray-200"}),(0,r.jsx)("button",{type:"button",className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50",onClick:S,children:"Keluar"})]})]})]})]})}),(0,r.jsx)("main",{className:"flex-1 overflow-y-auto p-4 sm:p-6 lg:p-8",children:c})]})]})}},7301:function(e,s,t){t.r(s),t.d(s,{SyncProvider:function(){return o},useSync:function(){return d}});var r=t(7437),n=t(2265),a=t(7841),l=t(6986);let i=(0,n.createContext)(void 0),c={phase:"idle",phaseProgress:0,dataPushed:0,dataPulled:0,filesSynced:0,totalFiles:0};function o(e){let{children:s}=e,{user:t}=(0,l.useAuth)(),[o,d]=(0,n.useState)(null),[u,m]=(0,n.useState)(null),[x,h]=(0,n.useState)(!1),[f,N]=(0,n.useState)(c),[g,p]=(0,n.useState)(null),[E,y]=(0,n.useState)(null),b=(0,n.useRef)(null),A=(0,n.useRef)(null),j=(0,n.useCallback)(async()=>{if(t)try{let e=await a.Rb.getStatistics();d(e),y(null),e.processing>0?h(!0):x&&0===e.processing&&(h(!1),p(new Date))}catch(e){console.error("Failed to fetch sync statistics:",e),y(e.message||"Failed to fetch sync status")}},[t,x]),v=(0,n.useCallback)(async()=>{if(t)try{let e=await a.Rb.getFullSyncStatus();m(e)}catch(e){console.error("Failed to fetch full sync status:",e)}},[t]),D=async()=>{if(!x){h(!0),y(null);try{await a.Rb.syncAll(),await j(),p(new Date)}catch(e){console.error("Manual sync failed:",e),y(e.message||"Manual sync failed")}finally{h(!1)}}},_=async()=>{if(!x){h(!0),y(null),N({...c,phase:"push"});try{A.current=setInterval(async()=>{await v()},1e3),await a.Rb.runFullSync(),N({...c,phase:"complete"}),await j(),await v(),p(new Date)}catch(e){console.error("Full sync failed:",e),y(e.message||"Full sync failed"),N({...c,phase:"error"})}finally{h(!1),A.current&&(clearInterval(A.current),A.current=null)}}};return(0,n.useEffect)(()=>{if(!u||!x)return;let{dataSync:e,fileSync:s,isOnline:t}=u,r="idle";t?e.processing>0?r="push":s.inProgress>0||s.pending>0?r="files":0===e.pending&&0===s.pending&&(r="complete"):r="error",N(t=>({...t,phase:r,dataPushed:e.synced,dataPulled:e.synced,filesSynced:s.completed,totalFiles:s.completed+s.pending+s.inProgress,currentFile:s.currentFile,phaseProgress:s.currentProgress||0}))},[u,x]),(0,n.useEffect)(()=>(t?(j(),v(),b.current=setInterval(()=>{j(),v()},3e4)):(b.current&&(clearInterval(b.current),b.current=null),d(null),m(null)),()=>{b.current&&clearInterval(b.current),A.current&&clearInterval(A.current)}),[t,j,v]),(0,r.jsx)(i.Provider,{value:{statistics:o,fullSyncStatus:u,isSyncing:x,syncProgress:f,lastSyncedAt:g,error:E,triggerSync:D,triggerFullSync:_,refreshStatistics:j},children:s})}function d(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useSync must be used within a SyncProvider");return e}},7841:function(e,s,t){t.d(s,{Rb:function(){return l},Wp:function(){return n}});var r,n,a=t(6383);(r=n||(n={})).USE_LOCAL="USE_LOCAL",r.USE_REMOTE="USE_REMOTE",r.MERGE="MERGE",r.MANUAL="MANUAL";let l={getStatistics:async()=>(await a.Z.get("/offline-queue/statistics")).data,getQueueItems:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return(await a.Z.get("/offline-queue/pending",{params:{limit:e}})).data},resolveConflict:async(e,s,t)=>(await a.Z.put("/offline-queue/".concat(e,"/resolve-conflict"),{resolution:s,mergedData:t})).data,retryItem:async e=>(await a.Z.put("/offline-queue/".concat(e,"/retry"))).data,syncAll:async()=>(await a.Z.post("/offline-queue/sync-all")).data,runFullSync:async()=>(await a.Z.post("/offline-queue/full-sync")).data,getFullSyncStatus:async()=>(await a.Z.get("/offline-queue/full-sync-status")).data,getFileSyncStatus:async()=>(await a.Z.get("/offline-queue/files/status")).data,syncFiles:async()=>(await a.Z.post("/offline-queue/files/sync")).data,getPendingFiles:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return(await a.Z.get("/offline-queue/files/pending",{params:{limit:e}})).data}}}}]);