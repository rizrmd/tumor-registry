"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8888],{8888:function(e,t,a){a.r(t),a.d(t,{WhoClassificationTree:function(){return C}});var s=a(7437),r=a(2265),n=a(2929),i=a(260),o=a(6219),c=a(8872),l=a(7805),d=a(4164),u=a(3217),g=a(8682);let m=e=>{let{classification:t,isSelected:a,isFavorite:r,onSelect:n,onToggleFavorite:o,showCodes:c=!0,depth:d=0}=e;return(0,s.jsxs)("div",{className:"group relative border-b border-gray-100 last:border-b-0 transition-colors ".concat(a?"bg-blue-50 border-l-4 border-l-blue-600":"hover:bg-gray-50"),children:[(0,s.jsx)("button",{type:"button",onClick:n,className:"w-full px-4 py-3 text-left flex items-start gap-3 ".concat(d>0?"pl-".concat(4*d):""),children:(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-900 leading-snug",children:t.name||t.diagnosis}),t.subcategory&&(0,s.jsx)("p",{className:"mt-0.5 text-xs text-gray-600",children:t.subcategory})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[t.isMalignant&&(0,s.jsx)("span",{className:"inline-flex items-center rounded-full bg-red-50 px-2 py-0.5 text-xs font-medium text-red-700 border border-red-200",children:"Malignant"}),!1===t.isMalignant&&(0,s.jsx)("span",{className:"inline-flex items-center rounded-full bg-green-50 px-2 py-0.5 text-xs font-medium text-green-700 border border-green-200",children:"Benign"}),a&&(0,s.jsx)(l.Z,{className:"h-5 w-5 text-blue-600 flex-shrink-0","aria-hidden":"true"})]})]}),c&&t.icdO3Code&&(0,s.jsx)("div",{className:"mt-1.5 flex items-center gap-1.5",children:(0,s.jsxs)("span",{className:"inline-flex items-center rounded bg-gray-100 px-2 py-0.5 text-xs font-mono text-gray-700",children:["ICD-O-3: ",t.icdO3Code]})})]})}),(0,s.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),o()},className:"absolute right-3 top-3 opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-gray-100 rounded-full",title:r?"Remove from favorites":"Add to favorites",children:r?(0,s.jsx)(g.Z,{className:"h-5 w-5 text-yellow-500"}):(0,s.jsx)(i.Z,{className:"h-5 w-5 text-gray-400 hover:text-yellow-500"})})]})},x=e=>{let{name:t,count:a,isExpanded:r,onToggle:n}=e;return(0,s.jsxs)("button",{type:"button",onClick:n,className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[r?(0,s.jsx)(d.Z,{className:"h-5 w-5 text-gray-500"}):(0,s.jsx)(u.Z,{className:"h-5 w-5 text-gray-500"}),(0,s.jsx)("span",{className:"font-semibold text-gray-900",children:t})]}),(0,s.jsx)("span",{className:"text-sm text-gray-600 font-medium bg-white px-2.5 py-0.5 rounded-full border border-gray-200",children:a})]})};var h=a(4020),y=a(6689);let f=e=>{let{value:t,onChange:a,placeholder:r="Search by name, category, or ICD-O-3 code...",resultCount:n,className:i=""}=e;return(0,s.jsxs)("div",{className:"relative ".concat(i),children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:(0,s.jsx)(h.Z,{className:"h-5 w-5 text-gray-400"})}),(0,s.jsx)("input",{type:"text",value:t,onChange:e=>a(e.target.value),placeholder:r,className:"block w-full rounded-lg border border-gray-300 bg-white py-2.5 pl-10 pr-10 text-sm text-gray-900 placeholder-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500"}),t&&(0,s.jsx)("button",{type:"button",onClick:()=>a(""),className:"absolute inset-y-0 right-0 flex items-center pr-3 hover:text-gray-700",children:(0,s.jsx)(y.Z,{className:"h-5 w-5 text-gray-400"})})]}),t&&void 0!==n&&(0,s.jsx)("p",{className:"mt-1.5 text-xs text-gray-600",children:0===n?(0,s.jsx)("span",{className:"text-red-600",children:"No results found"}):(0,s.jsxs)("span",{children:["Found ",(0,s.jsx)("span",{className:"font-semibold",children:n})," result",1!==n?"s":""]})})]})};var p=a(432),b=a(6917);let v=e=>{let{classification:t,onClear:a,showCodes:r=!0,className:n=""}=e,i=[t.category,t.subcategory,t.name].filter(Boolean).join(" > ");return(0,s.jsx)("div",{className:"rounded-lg border-2 border-blue-200 bg-blue-50 p-4 ".concat(n),children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(p.Z,{className:"h-6 w-6 text-blue-600 flex-shrink-0 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-blue-900",children:"Selected Classification"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-blue-800 break-words",children:i}),(0,s.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[void 0!==t.isMalignant&&(0,s.jsx)("span",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ".concat(t.isMalignant?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"),children:t.isMalignant?"Malignant":"Benign"}),r&&t.icdO3Code&&(0,s.jsxs)("span",{className:"inline-flex items-center rounded-md bg-blue-100 px-2.5 py-0.5 text-xs font-mono font-medium text-blue-900 border border-blue-200",children:["ICD-O-3: ",t.icdO3Code]})]})]}),(0,s.jsxs)("button",{type:"button",onClick:a,className:"flex items-center gap-1.5 rounded-md bg-white px-3 py-1.5 text-sm font-medium text-blue-700 shadow-sm hover:bg-blue-50 border border-blue-200 transition-colors",children:[(0,s.jsx)(b.Z,{className:"h-4 w-4"}),"Change"]})]})})};var w=a(9891),N=a(9996);let j={RECENT_BONE:"who_recent_bone_classifications",RECENT_SOFT_TISSUE:"who_recent_soft_tissue_classifications",FAVORITES_BONE:"who_favorites_bone_classifications",FAVORITES_SOFT_TISSUE:"who_favorites_soft_tissue_classifications"},C=e=>{let{tumorType:t,selectedId:a,onSelect:l,searchable:d=!0,showCodes:u=!0,showRecent:g=!0,showFavorites:h=!0,enableKeyboardNav:y=!0,className:p=""}=e,{data:b,isLoading:C,isError:S,error:Z,categories:E,getById:k}=function(e){var t,a;let{tumorType:s,category:r,isMalignant:n}=e,i=["who-classifications",s,r,n],o=(0,w.a)({queryKey:i,queryFn:async()=>{let e=("BONE"===s?await N.S_.getWhoBoneTumors({category:r,isMalignant:n}):await N.S_.getWhoSoftTissueTumors({category:r,isMalignant:n})).map(e=>({id:e.id,name:e.diagnosis,category:e.category,subcategory:e.subcategory,diagnosis:e.diagnosis,icdO3Code:e.icdO3Code,isMalignant:e.isMalignant,sortOrder:e.sortOrder}));e.sort((e,t)=>(e.sortOrder||0)-(t.sortOrder||0));let t=new Map;e.forEach(e=>{let a=e.category;t.has(a)||t.set(a,{id:"category-".concat(a),name:a,isCategory:!0,children:[]}),t.get(a).children.push(e)});let a=Array.from(t.values()).sort((e,t)=>e.name.localeCompare(t.name)),i=new Map;return e.forEach(e=>i.set(e.id,e)),{raw:e,grouped:a,flatMap:i}},staleTime:3e5,gcTime:6e5,retry:2,enabled:!0});return{...o,classifications:(null===(t=o.data)||void 0===t?void 0:t.raw)||[],categories:(null===(a=o.data)||void 0===a?void 0:a.grouped)||[],getById:e=>{var t;return null===(t=o.data)||void 0===t?void 0:t.flatMap.get(e)}}}({tumorType:t}),{searchQuery:O,setSearchQuery:T,filteredCategories:_,resultCount:B}=function(e){let{classifications:t,categories:a,searchableFields:s=["name","category","icdO3Code"]}=e,[n,i]=(0,r.useState)(""),o=(0,r.useMemo)(()=>{if(!n.trim())return[];let e=n.toLowerCase(),a=[];return t.forEach(t=>{var r;let n;let i=null;s.includes("name")&&t.name.toLowerCase().includes(e)?(i="name",n=t.name):s.includes("icdO3Code")&&(null===(r=t.icdO3Code)||void 0===r?void 0:r.toLowerCase().includes(e))?(i="icdO3",n=t.icdO3Code):s.includes("category")&&t.category.toLowerCase().includes(e)&&(i="category",n=t.category),i&&a.push({classification:t,matchType:i,highlightText:n})}),a},[t,n,s]),c=(0,r.useMemo)(()=>{if(!n.trim())return a;let e=n.toLowerCase();return a.map(t=>{let a=t.children.filter(t=>{var a;return t.name.toLowerCase().includes(e)||t.category.toLowerCase().includes(e)||(null===(a=t.icdO3Code)||void 0===a?void 0:a.toLowerCase().includes(e))});return a.length>0?{...t,children:a,expanded:!0}:t.name.toLowerCase().includes(e)?{...t,expanded:!0}:null}).filter(e=>null!==e)},[a,n]);return{searchQuery:n,setSearchQuery:i,searchResults:o,filteredCategories:c,hasResults:o.length>0,resultCount:o.length,highlightMatch:(e,t)=>{if(!t.trim())return e;let a=RegExp("(".concat(t,")"),"gi");return e.replace(a,'<mark class="bg-yellow-200 font-semibold">$1</mark>')}}}({classifications:(null==b?void 0:b.raw)||[],categories:E||[]}),{recents:I,addRecent:F,hasRecents:R}=function(e){let t="BONE"===e?j.RECENT_BONE:j.RECENT_SOFT_TISSUE,[a,s]=(0,r.useState)([]);(0,r.useEffect)(()=>{try{let e=localStorage.getItem(t);if(e){let t=JSON.parse(e);s(Array.isArray(t)?t:[])}}catch(e){console.error("Error loading recent selections:",e),s([])}},[t]);let n=(0,r.useCallback)(e=>{try{localStorage.setItem(t,JSON.stringify(e))}catch(e){console.error("Error saving recent selections:",e)}},[t]);return{recents:a,addRecent:(0,r.useCallback)((e,t,a)=>{s(s=>{let r=s.filter(t=>t.id!==e),i=[{id:e,name:t,category:a,timestamp:Date.now()},...r].slice(0,5);return n(i),i})},[n]),clearRecents:(0,r.useCallback)(()=>{s([]),n([])},[n]),removeRecent:(0,r.useCallback)(e=>{s(t=>{let a=t.filter(t=>t.id!==e);return n(a),a})},[n]),hasRecents:a.length>0}}(t),{favorites:U,isFavorite:A,toggleFavorite:M,hasFavorites:L}=function(e){let t="BONE"===e?j.FAVORITES_BONE:j.FAVORITES_SOFT_TISSUE,[a,s]=(0,r.useState)([]);(0,r.useEffect)(()=>{try{let e=localStorage.getItem(t);if(e){let t=JSON.parse(e);s(Array.isArray(t)?t:[])}}catch(e){console.error("Error loading favorites:",e),s([])}},[t]);let n=(0,r.useCallback)(e=>{try{localStorage.setItem(t,JSON.stringify(e))}catch(e){console.error("Error saving favorites:",e)}},[t]),i=(0,r.useCallback)(e=>a.some(t=>t.id===e),[a]);return{favorites:a,isFavorite:i,toggleFavorite:(0,r.useCallback)((t,a,r)=>{s(s=>{let i;return n(i=s.some(e=>e.id===t)?s.filter(e=>e.id!==t):[...s,{id:t,name:a,category:r,tumorType:e}]),i})},[e,n]),clearFavorites:(0,r.useCallback)(()=>{s([]),n([])},[n]),removeFavorite:(0,r.useCallback)(e=>{s(t=>{let a=t.filter(t=>t.id!==e);return n(a),a})},[n]),hasFavorites:a.length>0}}(t),[P,D]=(0,r.useState)(new Set),[W,J]=(0,r.useState)("tree"),[V,q]=(0,r.useState)(-1),H=(0,r.useRef)(null),X=a?k(a):void 0;(0,r.useEffect)(()=>{if(O){let e=_.map(e=>e.id);D(new Set(e))}},[O,_]);let $=(0,r.useCallback)(e=>{D(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},[]),z=(0,r.useCallback)(()=>{let e=(O?_:E).map(e=>e.id);D(new Set(e))},[E,_,O]),G=(0,r.useCallback)(()=>{D(new Set)},[]),K=(0,r.useCallback)(e=>{l(e),F(e.id,e.name,e.category)},[l,F]),Q=(0,r.useCallback)(e=>{M(e.id,e.name,e.category)},[M]);if((0,r.useEffect)(()=>{if(!y)return;let e=e=>{var t;if(null===(t=H.current)||void 0===t?void 0:t.contains(document.activeElement))switch(e.key){case"ArrowDown":e.preventDefault(),q(e=>Math.min(e+1,B-1));break;case"ArrowUp":e.preventDefault(),q(e=>Math.max(e-1,0));break;case"Enter":e.preventDefault()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[y,B]),C)return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center p-12 ".concat(p),children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent"}),(0,s.jsxs)("p",{className:"mt-4 text-sm font-medium text-gray-600",children:["Loading ","BONE"===t?"bone":"soft tissue"," tumor classifications..."]})]});if(S)return(0,s.jsxs)("div",{className:"rounded-lg bg-red-50 border border-red-200 p-6 ".concat(p),children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-red-800",children:"Failed to load classifications"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-red-700",children:Z instanceof Error?Z.message:"An unexpected error occurred"}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 inline-flex items-center rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700",children:"Retry"})]});let Y=O?_:E;return(0,s.jsxs)("div",{className:"space-y-4 ".concat(p),ref:H,children:[X&&(0,s.jsx)(v,{classification:X,onClear:()=>l({id:"",name:"",category:""}),showCodes:u}),d&&(0,s.jsx)(f,{value:O,onChange:T,resultCount:O?B:void 0}),(0,s.jsx)("div",{className:"border-b border-gray-200",children:(0,s.jsxs)("nav",{className:"-mb-px flex space-x-6",children:[(0,s.jsx)("button",{onClick:()=>J("tree"),className:"whitespace-nowrap border-b-2 pb-3 px-1 text-sm font-medium transition-colors ".concat("tree"===W?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:border-gray-300 hover:text-gray-800"),children:"All Classifications"}),g&&R&&(0,s.jsxs)("button",{onClick:()=>J("recents"),className:"whitespace-nowrap border-b-2 pb-3 px-1 text-sm font-medium transition-colors flex items-center gap-1.5 ".concat("recents"===W?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:border-gray-300 hover:text-gray-800"),children:[(0,s.jsx)(n.Z,{className:"h-4 w-4"}),"Recent (",I.length,")"]}),h&&L&&(0,s.jsxs)("button",{onClick:()=>J("favorites"),className:"whitespace-nowrap border-b-2 pb-3 px-1 text-sm font-medium transition-colors flex items-center gap-1.5 ".concat("favorites"===W?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:border-gray-300 hover:text-gray-800"),children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),"Favorites (",U.length,")"]})]})}),"tree"===W&&!O&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[E.length," categories, ",(null==b?void 0:b.raw.length)||0," classifications"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:z,className:"inline-flex items-center gap-1.5 rounded-md bg-gray-100 px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-200 transition-colors",children:[(0,s.jsx)(o.Z,{className:"h-3.5 w-3.5"}),"Expand All"]}),(0,s.jsxs)("button",{onClick:G,className:"inline-flex items-center gap-1.5 rounded-md bg-gray-100 px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-200 transition-colors",children:[(0,s.jsx)(c.Z,{className:"h-3.5 w-3.5"}),"Collapse All"]})]})]}),(0,s.jsx)("div",{className:"rounded-lg border border-gray-300 bg-white shadow-sm overflow-hidden",children:(0,s.jsxs)("div",{className:"max-h-[500px] overflow-y-auto",children:["tree"===W&&(0,s.jsx)(s.Fragment,{children:0===Y.length?(0,s.jsx)("div",{className:"p-8 text-center",children:(0,s.jsx)("p",{className:"text-sm text-gray-600",children:O?"No classifications found matching your search.":"No classifications available."})}):Y.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)(x,{name:e.name,count:e.children.length,isExpanded:P.has(e.id),onToggle:()=>$(e.id)}),P.has(e.id)&&(0,s.jsx)("div",{className:"bg-white divide-y divide-gray-100",children:e.children.map(e=>(0,s.jsx)(m,{classification:e,isSelected:a===e.id,isFavorite:A(e.id),onSelect:()=>K(e),onToggleFavorite:()=>Q(e),showCodes:u},e.id))})]},e.id))}),"recents"===W&&(0,s.jsx)("div",{className:"divide-y divide-gray-100",children:I.map(e=>{let t=k(e.id);return t?(0,s.jsx)(m,{classification:t,isSelected:a===e.id,isFavorite:A(e.id),onSelect:()=>K(t),onToggleFavorite:()=>Q(t),showCodes:u},e.id):null})}),"favorites"===W&&(0,s.jsx)("div",{className:"divide-y divide-gray-100",children:U.map(e=>{let t=k(e.id);return t?(0,s.jsx)(m,{classification:t,isSelected:a===e.id,isFavorite:!0,onSelect:()=>K(t),onToggleFavorite:()=>Q(t),showCodes:u},e.id):null})})]})})]})}},4894:function(e,t,a){var s=a(6383);class r{async fetchCenters(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await s.Z.get("/centers",{params:{includeInactive:e.toString()}})).data}async fetchCenterById(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(await s.Z.get("/centers/".concat(e),{params:{includeUsers:t.toString()}})).data}async fetchStatistics(){return(await s.Z.get("/centers/statistics")).data}async createCenter(e){return(await s.Z.post("/centers",e)).data}async updateCenter(e,t){return(await s.Z.put("/centers/".concat(e),t)).data}async activateCenter(e){return(await s.Z.put("/centers/".concat(e,"/activate"))).data}async deactivateCenter(e){return(await s.Z.put("/centers/".concat(e,"/deactivate"))).data}async deleteCenter(e){await s.Z.delete("/centers/".concat(e))}async getCenterUsers(e){return(await s.Z.get("/centers/".concat(e,"/users"))).data}}t.Z=new r},9996:function(e,t,a){a.d(t,{eH:function(){return i.Z},S_:function(){return n},Xv:function(){return c}}),a(905),a(379);var s=a(6383);class r{async getCenters(e){return(await s.Z.get("/centers",{params:e})).data.data}async getCenterById(e){return(await s.Z.get("/centers/".concat(e))).data.data}async getPathologyTypes(){return(await s.Z.get("/pathology-types")).data.data}async getWhoBoneTumors(e){return(await s.Z.get("/who-classifications/bone",{params:e})).data}async getWhoBoneTumorById(e){return(await s.Z.get("/who-classifications/bone/".concat(e))).data}async getWhoSoftTissueTumors(e){return(await s.Z.get("/who-classifications/soft-tissue",{params:e})).data}async getWhoSoftTissueTumorById(e){return(await s.Z.get("/who-classifications/soft-tissue/".concat(e))).data}async getBoneLocations(e){return(await s.Z.get("/locations/bone",{params:e})).data}async getBoneLocationById(e){return(await s.Z.get("/locations/bone/".concat(e))).data}async getSoftTissueLocations(e){return(await s.Z.get("/locations/soft-tissue",{params:e})).data}async getSoftTissueLocationById(e){return(await s.Z.get("/locations/soft-tissue/".concat(e))).data}async getTumorSyndromes(){return(await s.Z.get("/tumor-syndromes")).data}async getTumorSyndromeById(e){return(await s.Z.get("/tumor-syndromes/".concat(e))).data}}var n=new r,i=a(4894);class o{async fetchUsers(){return(await s.Z.get("/users")).data}async fetchUserById(e){return(await s.Z.get("/users/".concat(e))).data}async fetchUsersByCenter(e){return(await s.Z.get("/users/center/".concat(e))).data}async createUser(e){return(await s.Z.post("/users",e)).data}async updateUser(e,t){return(await s.Z.patch("/users/".concat(e),t)).data}async changeUserRole(e,t){return(await s.Z.patch("/users/".concat(e,"/role"),t)).data}async toggleUserStatus(e,t){return(await s.Z.patch("/users/".concat(e,"/status"),t)).data}async deleteUser(e){await s.Z.delete("/users/".concat(e))}async activateUser(e){return this.toggleUserStatus(e,{isActive:!0})}async deactivateUser(e){return this.toggleUserStatus(e,{isActive:!1})}}var c=new o},379:function(e,t,a){var s=a(6383);class r{async createPatient(e){return(await s.Z.post("/patients",e)).data.data}async getPatients(e){var t;let a=await s.Z.get("/patients",{params:e});return{data:a.data.patients||[],meta:a.data.pagination||{page:1,limit:50,total:(null===(t=a.data.patients)||void 0===t?void 0:t.length)||0,totalPages:1}}}async getPatientById(e){return(await s.Z.get("/patients/".concat(e))).data}async getPatientByMRN(e,t){return(await s.Z.get("/patients/mrn/".concat(e),{params:{centerId:t}})).data.data}async updatePatient(e,t){return(await s.Z.patch("/patients/".concat(e),t)).data.data}async deletePatient(e){await s.Z.delete("/patients/".concat(e))}async searchPatients(e,t){return(await s.Z.get("/patients/search",{params:{q:e,centerId:t}})).data.data}async getPatientStatistics(e){return(await s.Z.get("/patients/statistics",{params:{centerId:e}})).data.data}async exportPatients(e,t){return(await s.Z.get("/patients/export/".concat(e),{params:t,responseType:"blob"})).data}}t.Z=new r}}]);