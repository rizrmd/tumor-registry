(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8005],{2898:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),n=(e,t)=>{let a=(0,s.forwardRef)(({color:a="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:c="",children:x,...o},m)=>(0,s.createElement)("svg",{ref:m,...r,width:n,height:n,stroke:a,strokeWidth:d?24*Number(l)/Number(n):l,className:["lucide",`lucide-${i(e)}`,c].join(" "),...o},[...t.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(x)?x:[x]]));return a.displayName=`${e}`,a}},6637:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(2898).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},4785:function(e,t,a){Promise.resolve().then(a.bind(a,9680))},9680:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return j}});var s,r,i=a(7437),n=a(2265),l=a(6986),d=a(7372),c=a(6383);(s=r||(r={})).DRAFT="draft",s.SUBMITTED="submitted",s.APPROVED="approved",s.REJECTED="rejected",s.EXPIRED="expired";class x{async getPendingRequests(){return(await c.Z.get("/research-requests/pending")).data}async getRequestDetails(e){return(await c.Z.get("/research-requests/".concat(e))).data}async approveRequest(e,t){return(await c.Z.post("/research-requests/".concat(e,"/approve"),{approved:!0,approvalNotes:t})).data}async rejectRequest(e,t){return(await c.Z.post("/research-requests/".concat(e,"/approve"),{approved:!1,rejectionReason:t})).data}}var o=new x,m=a(6637),h=a(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,h.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),p=(0,h.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),g=(0,h.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),y=(0,h.Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function j(){let{user:e,isAuthenticated:t,isLoading:a}=(0,l.useAuth)(),[s,r]=(0,n.useState)([]),[c,x]=(0,n.useState)(!0),[h,j]=(0,n.useState)(null),[f,b]=(0,n.useState)(null),[N,v]=(0,n.useState)(!1),[w,k]=(0,n.useState)(!1),[C,q]=(0,n.useState)(""),[D,P]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(!a&&!t){window.location.href="/login";return}t&&S()},[t,a]);let S=async()=>{try{x(!0);let e=await o.getPendingRequests();r(e)}catch(e){console.error("Failed to fetch pending requests:",e),j("Gagal memuat daftar permintaan penelitian.")}finally{x(!1)}},E=async e=>{if(confirm('Setujui permintaan penelitian "'.concat(e.title,'"? Peneliti akan mendapatkan akses ke statistik yang diminta.')))try{P(e.id),await o.approveRequest(e.id),alert("Permintaan berhasil disetujui."),v(!1),S()}catch(e){var t,a;console.error("Failed to approve request:",e),alert((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Gagal menyetujui permintaan.")}finally{P(null)}},R=async()=>{if(f&&C.trim())try{P(f.id),await o.rejectRequest(f.id,C),alert("Permintaan berhasil ditolak."),k(!1),v(!1),q(""),S()}catch(a){var e,t;console.error("Failed to reject request:",a),alert((null===(t=a.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Gagal menolak permintaan.")}finally{P(null)}},T=e=>{b(e),k(!0)},Z=e=>{b(e),v(!0)};return a||c?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):(0,i.jsxs)(d.A,{children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Persetujuan Penelitian"}),(0,i.jsx)("p",{className:"text-gray-600 mt-1",children:"Review dan kelola permintaan data penelitian dari pengguna."})]}),h&&(0,i.jsx)("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg mb-6 border border-red-200",children:h}),(0,i.jsx)("div",{className:"bg-white rounded-lg shadow border overflow-hidden",children:0===s.length?(0,i.jsxs)("div",{className:"p-12 text-center text-gray-500",children:[(0,i.jsx)(m.Z,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Tidak ada permintaan menunggu"}),(0,i.jsx)("p",{children:"Semua permintaan penelitian telah diproses."})]}):(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,i.jsx)("thead",{className:"bg-gray-50",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Judul Penelitian"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Peneliti"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal Submit"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Est. Pasien"}),(0,i.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),(0,i.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>(0,i.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,i.jsxs)("td",{className:"px-6 py-4",children:[(0,i.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,i.jsx)("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:e.description})]}),(0,i.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(u,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,i.jsx)("div",{className:"text-sm text-gray-900",children:e.requesterName})]}),(0,i.jsx)("div",{className:"text-xs text-gray-500 ml-6",children:e.requesterEmail})]}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,i.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,i.jsx)(p,{className:"h-4 w-4 mr-2"}),new Date(e.submittedAt).toLocaleDateString("id-ID")]})}),(0,i.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,i.jsx)("div",{className:"text-sm text-gray-900",children:e.patientCount?e.patientCount.toLocaleString():"-"})}),(0,i.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[(0,i.jsx)("button",{onClick:()=>Z(e),className:"px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-50 text-gray-700",children:"Detail"}),(0,i.jsxs)("button",{onClick:()=>E(e),disabled:D===e.id,className:"px-3 py-1 bg-green-600 rounded hover:bg-green-700 text-white flex items-center inline-flex",children:[(0,i.jsx)(g,{className:"h-4 w-4 mr-1"}),"Setuju"]}),(0,i.jsxs)("button",{onClick:()=>T(e),disabled:D===e.id,className:"px-3 py-1 bg-red-600 rounded hover:bg-red-700 text-white flex items-center inline-flex",children:[(0,i.jsx)(y,{className:"h-4 w-4 mr-1"}),"Tolak"]})]})]},e.id))})]})})}),N&&f&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto flex flex-col",children:[(0,i.jsxs)("div",{className:"p-6 border-b",children:[(0,i.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Detail Permintaan Penelitian"}),(0,i.jsxs)("p",{className:"text-sm text-gray-500",children:["ID: ",f.id]})]}),(0,i.jsxs)("div",{className:"p-6 space-y-6 overflow-y-auto flex-1",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-gray-500",children:"Judul"}),(0,i.jsx)("p",{className:"text-gray-900",children:f.title})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-gray-500",children:"IRB / No. Ethics"}),(0,i.jsx)("p",{className:"text-gray-900",children:f.irbNumber||"-"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-gray-500",children:"Deskripsi"}),(0,i.jsx)("p",{className:"text-gray-900 text-sm whitespace-pre-wrap",children:f.description})]}),(0,i.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Filter Data Yang Diminta"}),(0,i.jsx)("pre",{className:"text-xs text-gray-600 overflow-x-auto",children:JSON.stringify(f.filters,null,2)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-gray-500",children:"Justifikasi Ilmiah"}),(0,i.jsx)("p",{className:"text-gray-900 text-sm",children:f.justification||"Tidak ada justifikasi disertakan."})]}),(0,i.jsxs)("div",{className:"border-t pt-4 flex justify-between items-center",children:[(0,i.jsxs)("div",{className:"text-sm text-gray-500",children:["Diajukan oleh: ",(0,i.jsx)("span",{className:"font-semibold text-gray-900",children:f.requesterName})," (",f.requesterEmail,")"]}),(0,i.jsxs)("div",{className:"text-sm text-gray-500",children:["Tanggal: ",new Date(f.submittedAt).toLocaleDateString("id-ID",{dateStyle:"full"})]})]})]}),(0,i.jsxs)("div",{className:"p-6 border-t flex justify-end space-x-2 bg-gray-50",children:[(0,i.jsx)("button",{onClick:()=>v(!1),className:"px-4 py-2 border bg-white rounded-md text-gray-700 hover:bg-gray-50",children:"Tutup"}),(0,i.jsx)("button",{onClick:()=>{f&&T(f)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Tolak"}),(0,i.jsx)("button",{onClick:()=>{f&&E(f)},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Setujui Permintaan"})]})]})}),w&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-lg",children:[(0,i.jsxs)("div",{className:"p-6 border-b",children:[(0,i.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Tolak Permintaan"}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"Mohon berikan alasan penolakan untuk peneliti."})]}),(0,i.jsx)("div",{className:"p-6",children:(0,i.jsx)("textarea",{placeholder:"Alasan penolakan...",value:C,onChange:e=>q(e.target.value),rows:4,className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-green-500 focus:outline-none"})}),(0,i.jsxs)("div",{className:"p-6 border-t flex justify-end space-x-2 bg-gray-50",children:[(0,i.jsx)("button",{onClick:()=>k(!1),className:"px-4 py-2 border bg-white rounded-md text-gray-700 hover:bg-gray-50",children:"Batal"}),(0,i.jsx)("button",{onClick:R,disabled:!C.trim(),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:"Konfirmasi Penolakan"})]})]})})]})}},4033:function(e,t,a){e.exports=a(5313)}},function(e){e.O(0,[4737,1956,7372,2971,4938,1744],function(){return e(e.s=4785)}),_N_E=e.O()}]);