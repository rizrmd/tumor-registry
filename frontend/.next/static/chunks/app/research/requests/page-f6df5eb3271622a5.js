(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[606],{3691:function(e,t,s){Promise.resolve().then(s.bind(s,8513))},8513:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(7437),i=s(2265),r=s(4033),n=s(6986),l=s(7372),d=s(833);function c(){let e=(0,r.useRouter)(),{user:t,isAuthenticated:s,isLoading:c}=(0,n.useAuth)(),[o,m]=(0,i.useState)([]),[x,u]=(0,i.useState)([]),[h,p]=(0,i.useState)(""),[g,j]=(0,i.useState)(!0),[f,v]=(0,i.useState)(!1),[y,b]=(0,i.useState)(null);(0,i.useEffect)(()=>{if(!c&&!s){window.location.href="/login";return}s&&N()},[s,c]),(0,i.useEffect)(()=>{h?u(o.filter(e=>e.status===h)):u(o)},[h,o]);let N=async()=>{try{j(!0);let e=(await d.Z.findAll()).map(e=>({id:e.requestNumber||e.id,title:e.title,requestedDate:e.submittedAt?new Date(e.submittedAt).toISOString().split("T")[0]:new Date(e.createdAt).toISOString().split("T")[0],status:w(e.status),dataType:"Anonymized",purpose:e.objectives||"",justification:e.researchAbstract||"",datasetDescription:Object.keys(e.requestedDataFields||{}).filter(t=>{var s;return null===(s=e.requestedDataFields[t])||void 0===s?void 0:s.selected}).join(", "),timeline:"".concat(e.accessDurationMonths||0," months"),reviewerNotes:e.adminNotes}));m(e),u(e)}catch(e){console.error("Error fetching requests:",e)}finally{j(!1)}},w=e=>({DRAFT:"Draft",SUBMITTED:"Submitted",PENDING_REVIEW:"Under Review",UNDER_REVIEW:"Under Review",NEED_MORE_INFO:"Under Review",APPROVED:"Approved",APPROVED_WITH_CONDITIONS:"Approved",REJECTED:"Rejected",DATA_READY:"Approved",ACTIVE:"In Progress",COMPLETED:"Completed",EXPIRED:"Completed"})[e]||"Submitted",k=e=>{switch(e){case"Draft":default:return"bg-gray-100 text-gray-800";case"Submitted":return"bg-blue-100 text-blue-800";case"Under Review":return"bg-yellow-100 text-yellow-800";case"Approved":return"bg-green-100 text-green-800";case"Rejected":return"bg-red-100 text-red-800";case"In Progress":return"bg-purple-100 text-purple-800";case"Completed":return"bg-teal-100 text-teal-800"}},D=e=>{switch(e){case"Aggregate":return"bg-blue-50 text-blue-700";case"Anonymized":return"bg-green-50 text-green-700";case"Identified":return"bg-orange-50 text-orange-700";default:return"bg-gray-50 text-gray-700"}},S=e=>{b(e),v(!0)},C=e=>{m(t=>t.map(t=>t.id===e?{...t,status:"Submitted"}:t)),alert("Permintaan berhasil diajukan untuk review")},A=e=>{confirm("Apakah Anda yakin ingin membatalkan permintaan ini?")&&(m(t=>t.filter(t=>t.id!==e)),alert("Permintaan dibatalkan"))},T=e=>{alert("Mengunduh data untuk permintaan ".concat(e,"...\nFitur download akan segera diimplementasikan."))};return c||g?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):s?(0,a.jsxs)(l.A,{children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Permintaan Data Penelitian"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Kelola permintaan akses data untuk penelitian"})]}),(0,a.jsx)("button",{onClick:()=>{e.push("/research/requests/new")},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium",children:"+ Permintaan Baru"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,a.jsx)("svg",{className:"h-6 w-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Permintaan"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:o.length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-yellow-100 rounded-lg",children:(0,a.jsx)("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Dalam Review"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:o.filter(e=>"Under Review"===e.status||"Submitted"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,a.jsx)("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Disetujui"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:o.filter(e=>"Approved"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-teal-100 rounded-lg",children:(0,a.jsx)("svg",{className:"h-6 w-6 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Selesai"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:o.filter(e=>"Completed"===e.status).length})]})]})})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Filter Status:"}),(0,a.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,a.jsx)("option",{value:"",children:"Semua Status"}),(0,a.jsx)("option",{value:"Draft",children:"Draft"}),(0,a.jsx)("option",{value:"Submitted",children:"Submitted"}),(0,a.jsx)("option",{value:"Under Review",children:"Under Review"}),(0,a.jsx)("option",{value:"Approved",children:"Approved"}),(0,a.jsx)("option",{value:"Rejected",children:"Rejected"}),(0,a.jsx)("option",{value:"In Progress",children:"In Progress"}),(0,a.jsx)("option",{value:"Completed",children:"Completed"})]}),h&&(0,a.jsx)("button",{onClick:()=>p(""),className:"text-sm text-red-600 hover:text-red-700 font-medium",children:"Reset Filter"})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Permintaan Saya (",x.length,")"]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Request ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Judul"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipe Data"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tujuan"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.id})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:e.title})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.requestedDate})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(k(e.status)),children:e.status})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded ".concat(D(e.dataType)),children:e.dataType})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:e.purpose})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>S(e),className:"text-blue-600 hover:text-blue-900 font-medium",children:"Detail"}),"Draft"===e.status&&(0,a.jsx)("button",{onClick:()=>C(e.id),className:"text-purple-600 hover:text-purple-900 font-medium",children:"Submit"}),("Draft"===e.status||"Submitted"===e.status)&&(0,a.jsx)("button",{onClick:()=>A(e.id),className:"text-red-600 hover:text-red-900 font-medium",children:"Batal"}),("Approved"===e.status||"Completed"===e.status)&&(0,a.jsx)("button",{onClick:()=>T(e.id),className:"text-green-600 hover:text-green-900 font-medium",children:"Download"})]})})]},e.id))})]})}),0===x.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,a.jsx)("p",{className:"mt-4 text-gray-500",children:"Tidak ada permintaan yang sesuai dengan filter"})]})]}),f&&y&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Detail Permintaan"}),(0,a.jsx)("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Request ID"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900 font-medium",children:y.id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Judul"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:y.title})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Tanggal Permintaan"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:y.requestedDate})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Status"}),(0,a.jsx)("span",{className:"inline-block mt-1 px-2 py-1 text-xs font-medium rounded-full ".concat(k(y.status)),children:y.status})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Tipe Data"}),(0,a.jsx)("span",{className:"inline-block mt-1 px-2 py-1 text-xs font-medium rounded ".concat(D(y.dataType)),children:y.dataType})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Tujuan Penelitian"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:y.purpose})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Justifikasi"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:y.justification})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Deskripsi Dataset"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:y.datasetDescription})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Timeline"}),(0,a.jsx)("p",{className:"mt-1 text-gray-900",children:y.timeline})]}),y.reviewerNotes&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-blue-900",children:"Catatan Reviewer"}),(0,a.jsx)("p",{className:"mt-1 text-blue-800",children:y.reviewerNotes})]})]}),(0,a.jsx)("div",{className:"flex justify-end mt-6",children:(0,a.jsx)("button",{onClick:()=>v(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:"Tutup"})})]})})})]}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Redirecting to login..."})]})})}},833:function(e,t,s){"use strict";var a=s(6383);class i{async create(e){return(await a.Z.post("/research-requests",e)).data}async update(e,t){return(await a.Z.patch("/research-requests/".concat(e),t)).data}async submit(e){return(await a.Z.post("/research-requests/".concat(e,"/submit"))).data}async getAll(e){return(await a.Z.get("/research-requests",{params:e})).data}async findAll(e){return this.getAll(e)}async getPending(){return(await a.Z.get("/research-requests/pending")).data}async estimatePatients(e){return(await a.Z.post("/research-requests/estimate",e)).data}async getOne(e){return(await a.Z.get("/research-requests/".concat(e))).data}async approveOrReject(e,t){return(await a.Z.post("/research-requests/".concat(e,"/approve"),t)).data}async delete(e){await a.Z.delete("/research-requests/".concat(e))}getPresetDataFields(e){return({basic_research:{demographics:{selected:!0,justification:"Basic demographics for patient characterization",subFields:{age:!0,gender:!0,region:!0}},diagnosisClassification:{selected:!0,justification:"Diagnosis and classification for tumor type analysis"},stagingData:{selected:!0,justification:"Staging data for disease severity assessment"}},outcome_study:{diagnosisClassification:{selected:!0,justification:"Diagnosis for outcome stratification"},stagingData:{selected:!0,justification:"Staging for baseline disease severity"},treatmentManagement:{selected:!0,justification:"Treatment details for outcome correlation"},followUpOutcomes:{selected:!0,justification:"Follow-up data and MSTS scores for outcome measurement"}},survival_analysis:{demographics:{selected:!0,justification:"Age and demographics as survival predictors",subFields:{age:!0,gender:!0}},diagnosisClassification:{selected:!0,justification:"Tumor type and grade for survival analysis"},stagingData:{selected:!0,justification:"Stage is primary survival predictor"},treatmentManagement:{selected:!0,justification:"Treatment modality affects survival"},followUpOutcomes:{selected:!0,justification:"Survival status and duration",subFields:{survivalStatus:!0,survivalDuration:!0}}},treatment_comparison:{diagnosisClassification:{selected:!0,justification:"Diagnosis for treatment stratification"},stagingData:{selected:!0,justification:"Baseline staging for comparison groups"},treatmentManagement:{selected:!0,justification:"Treatment details for comparison"},followUpOutcomes:{selected:!0,justification:"Outcomes for treatment effectiveness comparison"}}})[e]||{}}async generateExport(e){return(await a.Z.post("/research-requests/".concat(e,"/generate-export"))).data}async getDownloadUrl(e){return(await a.Z.get("/research-requests/".concat(e,"/download"))).data}async requestExtension(e,t,s){return(await a.Z.post("/research-requests/".concat(e,"/request-extension"),{extensionMonths:t,justification:s})).data}}let r=new i;t.Z=r},4033:function(e,t,s){e.exports=s(5313)}},function(e){e.O(0,[4737,1956,7372,2971,4938,1744],function(){return e(e.s=3691)}),_N_E=e.O()}]);