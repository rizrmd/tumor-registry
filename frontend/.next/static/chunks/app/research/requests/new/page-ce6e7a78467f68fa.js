(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9284],{3204:function(e,t,a){Promise.resolve().then(a.bind(a,9330))},9330:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var s=a(7437),i=a(2265),r=a(4033),l=a(2849),n=a(4968),d=a(7927);function c(e){let{formData:t,updateFormData:a}=e,{user:i}=(0,l.useAuth)();return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Informasi Penelitian"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Detail penelitian dan identitas peneliti"})]}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Informasi Peneliti (Auto-fill)"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Nama:"})," ",(0,s.jsx)("span",{className:"font-medium",children:null==i?void 0:i.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Email:"})," ",(0,s.jsx)("span",{className:"font-medium",children:null==i?void 0:i.email})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"No. HP (Opsional)"}),(0,s.jsx)("input",{type:"tel",value:t.researcherPhone||"",onChange:e=>a("researcherPhone",e.target.value),placeholder:"+62",className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Judul Penelitian ",(0,s.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,s.jsx)("input",{type:"text",value:t.title||"",onChange:e=>a("title",e.target.value),placeholder:"Judul lengkap penelitian Anda",className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tipe Penelitian ",(0,s.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,s.jsxs)("select",{value:t.researchType||"",onChange:e=>a("researchType",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0,children:[(0,s.jsx)("option",{value:"",children:"Pilih tipe penelitian"}),(0,s.jsx)("option",{value:"ACADEMIC",children:"Akademik (Skripsi/Tesis/Disertasi)"}),(0,s.jsx)("option",{value:"CLINICAL_TRIAL",children:"Clinical Trial"}),(0,s.jsx)("option",{value:"OBSERVATIONAL",children:"Observational Study"}),(0,s.jsx)("option",{value:"SYSTEMATIC_REVIEW",children:"Systematic Review"}),(0,s.jsx)("option",{value:"META_ANALYSIS",children:"Meta-analysis"}),(0,s.jsx)("option",{value:"OTHER",children:"Lainnya"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Abstrak Singkat ",(0,s.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,s.jsx)("textarea",{value:t.researchAbstract||"",onChange:e=>a("researchAbstract",e.target.value),placeholder:"Ringkasan singkat penelitian Anda (max 500 karakter)",rows:4,maxLength:500,className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0}),(0,s.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[(t.researchAbstract||"").length,"/500 karakter"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tujuan Penelitian ",(0,s.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,s.jsx)("textarea",{value:t.objectives||"",onChange:e=>a("objectives",e.target.value),placeholder:"Tujuan utama penelitian (max 300 karakter)",rows:3,maxLength:300,className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0}),(0,s.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[(t.objectives||"").length,"/300 karakter"]})]})]})}function o(e){let{formData:t,updateFormData:a}=e,[r,l]=(0,i.useState)(null),[n,c]=(0,i.useState)(!1),o=t.dataFilters||{},u=(e,t)=>{let s={...o,[e]:t};a("dataFilters",s)},m=async()=>{if(!o.periodStart||!o.periodEnd){alert("Silakan pilih periode data terlebih dahulu");return}c(!0);try{let e=await d.Z.estimatePatients(o);l(e.estimatedCount),a("estimatedPatientCount",e.estimatedCount)}catch(e){console.error("Error estimating:",e),alert("Gagal menghitung estimasi. Silakan coba lagi.")}finally{c(!1)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Kriteria Data"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Filter pasien dan estimasi jumlah data"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Periode Data - Dari ",(0,s.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,s.jsx)("input",{type:"date",value:o.periodStart||"",onChange:e=>u("periodStart",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Sampai ",(0,s.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,s.jsx)("input",{type:"date",value:o.periodEnd||"",onChange:e=>u("periodEnd",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jenis Tumor"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",value:"bone_tumor",className:"rounded"}),(0,s.jsx)("span",{children:"Bone Tumor"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",value:"soft_tissue_tumor",className:"rounded"}),(0,s.jsx)("span",{children:"Soft Tissue Tumor"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",value:"metastatic_bone_disease",className:"rounded"}),(0,s.jsx)("span",{children:"Metastatic Bone Disease"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Usia Min (tahun)"}),(0,s.jsx)("input",{type:"number",value:o.ageMin||"",onChange:e=>u("ageMin",parseInt(e.target.value)),min:"0",max:"120",className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Usia Max (tahun)"}),(0,s.jsx)("input",{type:"number",value:o.ageMax||"",onChange:e=>u("ageMax",parseInt(e.target.value)),min:"0",max:"120",className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]})]}),(0,s.jsx)("div",{className:"border-t pt-4",children:(0,s.jsx)("button",{onClick:m,disabled:n,className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:n?"Menghitung...":"\uD83D\uDD0D Hitung Estimasi Pasien"})}),null!==r&&(0,s.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-sm text-green-600 mb-1",children:"Estimasi Jumlah Pasien"}),(0,s.jsxs)("div",{className:"text-4xl font-bold text-green-900",children:["~",r]}),(0,s.jsx)("div",{className:"text-sm text-green-700 mt-1",children:"pasien sesuai kriteria Anda"})]})})]})}function u(e){let{formData:t,updateFormData:a}=e;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Timeline & Submit"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Tentukan timeline penelitian dan submit request Anda"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tanggal Mulai Penelitian ",(0,s.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,s.jsx)("input",{type:"date",value:t.researchStart||"",onChange:e=>a("researchStart",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tanggal Selesai ",(0,s.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,s.jsx)("input",{type:"date",value:t.researchEnd||"",onChange:e=>a("researchEnd",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Durasi Akses Data ",(0,s.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,s.jsxs)("select",{value:t.accessDurationMonths||"",onChange:e=>a("accessDurationMonths",parseInt(e.target.value)),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",required:!0,children:[(0,s.jsx)("option",{value:"",children:"Pilih durasi"}),(0,s.jsx)("option",{value:"3",children:"3 bulan"}),(0,s.jsx)("option",{value:"6",children:"6 bulan (recommended)"}),(0,s.jsx)("option",{value:"12",children:"12 bulan"}),(0,s.jsx)("option",{value:"24",children:"24 bulan"})]})]}),(0,s.jsx)("div",{className:"border-t pt-4",children:(0,s.jsxs)("label",{className:"flex items-start gap-3 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,s.jsx)("input",{type:"checkbox",checked:t.agreementSigned||!1,onChange:e=>{a("agreementSigned",e.target.checked),e.target.checked&&a("agreementDate",new Date().toISOString())},className:"mt-1 h-5 w-5 text-blue-600 rounded",required:!0}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("div",{className:"font-semibold text-gray-900 mb-2",children:["Data Protection Agreement ",(0,s.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,s.jsxs)("div",{className:"text-gray-700 space-y-1",children:[(0,s.jsx)("p",{children:"✓ Data hanya akan digunakan untuk tujuan penelitian yang disebutkan"}),(0,s.jsx)("p",{children:"✓ Data tidak akan dibagikan kepada pihak ketiga tanpa izin INAMSOS"}),(0,s.jsx)("p",{children:"✓ Publikasi akan mencantumkan acknowledgment ke INAMSOS"}),(0,s.jsx)("p",{children:"✓ Data akan dihapus setelah penelitian selesai"})]})]})]})})]})}let m=[{key:"demographics",label:"Demographics & Identity (Basic)",description:"Age, gender, provinsi/region only (TIDAK termasuk alamat lengkap)",sensitivityLevel:"LOW",sensitivityScore:10},{key:"demographicsIdentifiable",label:"Demographics Identifiable ⚠️",description:"NIK, Full Name, Full Address",sensitivityLevel:"VERY HIGH",sensitivityScore:40,requiresExtra:"Requires IRB approval + extra justification"},{key:"clinicalPresentation",label:"Clinical Presentation",description:"Chief complaint, symptoms, Karnofsky score, tumor size",sensitivityLevel:"LOW",sensitivityScore:5},{key:"diagnosisClassification",label:"Diagnosis & Classification ⭐",description:"WHO classification, tumor location, histopathology grade",sensitivityLevel:"LOW",sensitivityScore:5},{key:"stagingData",label:"Staging Data ⭐",description:"Enneking, AJCC staging, tumor size, metastasis status",sensitivityLevel:"LOW",sensitivityScore:5},{key:"diagnosticInvestigations",label:"Diagnostic Investigations",description:"Biopsy results, imaging studies, laboratory results, radiology findings",sensitivityLevel:"MEDIUM",sensitivityScore:10},{key:"treatmentManagement",label:"Treatment Management",description:"Surgery details, chemotherapy, radiotherapy, reconstruction",sensitivityLevel:"MEDIUM",sensitivityScore:10},{key:"followUpOutcomes",label:"Follow-up & Outcomes",description:"14-visit follow-up data, MSTS scores, recurrence, survival",sensitivityLevel:"MEDIUM",sensitivityScore:10},{key:"clinicalPhotosImaging",label:"Clinical Photos & Imaging Files ⚠️",description:"Clinical photographs and imaging files",sensitivityLevel:"VERY HIGH",sensitivityScore:35,requiresExtra:"Requires patient consent verification + IRB approval"},{key:"cpcRecords",label:"CPC Conference Records",description:"Multidisciplinary team conference notes and recommendations",sensitivityLevel:"LOW",sensitivityScore:5}];function x(e){let{formData:t,updateFormData:a}=e,[r,l]=(0,i.useState)(t.requestedDataFields||{}),[n,c]=(0,i.useState)(0),o=e=>{let t=d.Z.getPresetDataFields(e);l(t),a("requestedDataFields",t),g(t)},u=e=>{var t,s;let i={...r};(null===(t=i[e])||void 0===t?void 0:t.selected)?i[e]={selected:!1,justification:""}:i[e]={selected:!0,justification:(null===(s=i[e])||void 0===s?void 0:s.justification)||""},l(i),a("requestedDataFields",i),g(i)},x=(e,t)=>{let s={...r,[e]:{...r[e],justification:t}};l(s),a("requestedDataFields",s)},g=e=>{let t=0;m.forEach(a=>{var s;(null===(s=e[a.key])||void 0===s?void 0:s.selected)&&(t+=a.sensitivityScore)}),c(Math.min(t,100))},h=e=>e<=25?"LOW":e<=50?"MEDIUM":e<=75?"HIGH":"VERY HIGH",p=e=>{switch(e){case"LOW":return"bg-green-100 text-green-800";case"MEDIUM":return"bg-yellow-100 text-yellow-800";case"HIGH":return"bg-orange-100 text-orange-800";case"VERY HIGH":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=Object.values(r).filter(e=>null==e?void 0:e.selected).length;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Data Fields Selection"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Centang kategori data yang Anda butuhkan. Justifikasi WAJIB untuk setiap kategori yang dipilih."})]}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-blue-900 mb-3",children:"\uD83D\uDCA1 Quick Presets (Pilih Cepat):"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[(0,s.jsx)("button",{onClick:()=>o("basic_research"),className:"px-4 py-2 bg-white border border-blue-300 rounded text-sm hover:bg-blue-100 text-blue-900",children:"Basic Research"}),(0,s.jsx)("button",{onClick:()=>o("outcome_study"),className:"px-4 py-2 bg-white border border-blue-300 rounded text-sm hover:bg-blue-100 text-blue-900",children:"Outcome Study"}),(0,s.jsx)("button",{onClick:()=>o("survival_analysis"),className:"px-4 py-2 bg-white border border-blue-300 rounded text-sm hover:bg-blue-100 text-blue-900",children:"Survival Analysis"}),(0,s.jsx)("button",{onClick:()=>o("treatment_comparison"),className:"px-4 py-2 bg-white border border-blue-300 rounded text-sm hover:bg-blue-100 text-blue-900",children:"Treatment Comparison"})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Data Sensitivity Score"}),(0,s.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[n,"/100"]})]}),(0,s.jsxs)("div",{className:"px-4 py-2 rounded-full text-sm font-semibold ".concat(p(h(n))),children:[h(n)," SENSITIVITY"]})]}),(0,s.jsx)("div",{className:"space-y-3",children:m.map(e=>{var t,a;let i=(null===(t=r[e.key])||void 0===t?void 0:t.selected)||!1,l=(null===(a=r[e.key])||void 0===a?void 0:a.justification)||"";return(0,s.jsx)("div",{className:"border rounded-lg p-4 transition-all ".concat(i?"border-blue-500 bg-blue-50":"border-gray-300 bg-white"),children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("input",{type:"checkbox",checked:i,onChange:()=>u(e.key),className:"mt-1 h-5 w-5 text-blue-600 rounded focus:ring-blue-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsx)("label",{className:"text-lg font-semibold text-gray-900 cursor-pointer",onClick:()=>u(e.key),children:e.label}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat(p(e.sensitivityLevel)),children:e.sensitivityLevel}),(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["+",e.sensitivityScore," pts"]})]})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),e.requiresExtra&&(0,s.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-2 text-xs text-yellow-800 mb-2",children:["⚠️ ",e.requiresExtra]}),i&&(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Justifikasi (WAJIB) ",(0,s.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,s.jsx)("textarea",{value:l,onChange:t=>x(e.key,t.target.value),placeholder:"Jelaskan kenapa data ".concat(e.label," diperlukan untuk penelitian Anda..."),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:i}),l.length>0&&(0,s.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[l.length," karakter"]})]})]})]})},e.key)})}),(0,s.jsx)("div",{className:"bg-gray-100 border border-gray-300 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Total Kategori Dipilih"}),(0,s.jsxs)("div",{className:"text-xl font-bold text-gray-900",children:[b," dari ",m.length]})]}),b>0&&(0,s.jsx)("div",{className:"text-sm text-gray-600",children:b===m.length?(0,s.jsx)("span",{className:"text-orange-600 font-semibold",children:"⚠️ Full dataset request"}):(0,s.jsx)("span",{className:"text-green-600",children:"✓ Selective data request"})})]})}),n>75&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"text-red-600 text-xl",children:"⚠️"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold text-red-900 mb-1",children:"VERY HIGH Sensitivity Request"}),(0,s.jsx)("p",{className:"text-sm text-red-800",children:"This request includes highly sensitive data (NIK/Name or Clinical Photos). Expect longer review time and possible additional requirements from ethics committee."})]})]})}),0===b&&(0,s.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center",children:(0,s.jsx)("p",{className:"text-yellow-800",children:"Silakan pilih minimal 1 kategori data untuk melanjutkan."})})]})}let g=[{id:1,title:"Informasi Penelitian",description:"Detail penelitian dan peneliti"},{id:2,title:"Kriteria Data",description:"Filter dan estimasi pasien"},{id:3,title:"Data Fields",description:"Pilih kategori data yang dibutuhkan"},{id:4,title:"Timeline & Submit",description:"Timeline penelitian dan submit"}];function h(e){let{onComplete:t,onSaveDraft:a,initialData:r}=e,[l,n]=(0,i.useState)(1),[d,m]=(0,i.useState)(r||{}),[h,p]=(0,i.useState)(!1),[b,v]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=setInterval(()=>{Object.keys(d).length>0&&y()},12e4);return()=>clearInterval(e)},[d]);let y=async()=>{p(!0);try{await a(d),v(new Date)}catch(e){console.error("Error saving draft:",e)}finally{p(!1)}},j=(e,t)=>{m(a=>({...a,[e]:t}))},f=e=>{switch(e){case 1:return!!(d.title&&d.researchType&&d.researchAbstract&&d.objectives);case 2:return!!d.dataFilters;case 3:return!!(d.requestedDataFields&&N(d.requestedDataFields));case 4:return!!(d.irbStatus&&d.researchStart&&d.researchEnd&&d.accessDurationMonths&&d.agreementSigned);default:return!1}},N=e=>Object.values(e).some(e=>null==e?void 0:e.selected),k=async()=>{if(f(4))try{await t(d)}catch(e){console.error("Error submitting request:",e),alert("Gagal submit request. Silakan coba lagi.")}};return(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:g.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center flex-1",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center flex-1",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-semibold ".concat(l===e.id?"bg-blue-600 text-white":l>e.id?"bg-green-600 text-white":"bg-gray-300 text-gray-600"),children:l>e.id?"✓":e.id}),(0,s.jsxs)("div",{className:"mt-2 text-center",children:[(0,s.jsx)("div",{className:"text-sm font-medium ".concat(l===e.id?"text-blue-600":"text-gray-700"),children:e.title}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:e.description})]})]}),t<g.length-1&&(0,s.jsx)("div",{className:"h-1 flex-1 mx-4 ".concat(l>e.id?"bg-green-600":"bg-gray-300")})]},e.id))})}),(0,s.jsx)("div",{className:"mb-4 text-right text-sm text-gray-500",children:h?(0,s.jsxs)("span",{className:"flex items-center justify-end gap-2",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),"Menyimpan draft..."]}):b?(0,s.jsxs)("span",{children:["Terakhir disimpan: ",b.toLocaleTimeString("id-ID")]}):null}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-6",children:[1===l&&(0,s.jsx)(c,{formData:d,updateFormData:j}),2===l&&(0,s.jsx)(o,{formData:d,updateFormData:j}),3===l&&(0,s.jsx)(x,{formData:d,updateFormData:j}),4===l&&(0,s.jsx)(u,{formData:d,updateFormData:j})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:l>1&&(0,s.jsx)("button",{onClick:()=>{l>1&&n(l-1)},className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"← Kembali"})}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:y,disabled:h,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:h?"Menyimpan...":"Simpan Draft"}),l<4?(0,s.jsx)("button",{onClick:()=>{f(l)&&l<4&&(n(l+1),y())},disabled:!f(l),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Lanjut →"}):(0,s.jsx)("button",{onClick:k,disabled:!f(4),className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Submit untuk Approval"})]})]})]})}function p(){let{isAuthenticated:e,isLoading:t}=(0,l.useAuth)(),a=(0,r.useRouter)(),[c,o]=(0,i.useState)(null);if((0,i.useEffect)(()=>{t||e||a.push("/login")},[e,t,a]),t)return(0,s.jsx)(n.A,{children:(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})});if(!e)return null;let u=async e=>{try{let t=c;if(c)await d.Z.update(c,e);else{let a=await d.Z.create(e);t=a.id,o(a.id)}t&&(await d.Z.submit(t),alert("✅ Research request berhasil di-submit untuk approval!"),a.push("/research/requests"))}catch(a){var t,s;console.error("Error submitting request:",a);let e=(null===(s=a.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Terjadi kesalahan saat submit request";alert("❌ Gagal submit request: ".concat(e))}},m=async e=>{try{if(c)await d.Z.update(c,e);else{let t=await d.Z.create(e);o(t.id)}}catch(e){console.error("Error saving draft:",e)}};return(0,s.jsx)(n.A,{children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Research Data Request"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Permintaan akses data untuk penelitian muskuloskeletal tumor"}),(0,s.jsx)("div",{className:"mt-4 inline-flex items-center px-4 py-2 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:"4 Langkah - Checklist-Based Selection"})]}),(0,s.jsx)(h,{onComplete:u,onSaveDraft:m})]})})}},7927:function(e,t,a){"use strict";var s=a(762);class i{async create(e){let t=await s.Z.post("/research-requests",e);return t.data}async update(e,t){let a=await s.Z.patch("/research-requests/".concat(e),t);return a.data}async submit(e){let t=await s.Z.post("/research-requests/".concat(e,"/submit"));return t.data}async getAll(e){let t=await s.Z.get("/research-requests",{params:e});return t.data}async findAll(e){return this.getAll(e)}async getPending(){let e=await s.Z.get("/research-requests/pending");return e.data}async estimatePatients(e){let t=await s.Z.post("/research-requests/estimate",e);return t.data}async getOne(e){let t=await s.Z.get("/research-requests/".concat(e));return t.data}async approveOrReject(e,t){let a=await s.Z.post("/research-requests/".concat(e,"/approve"),t);return a.data}async delete(e){await s.Z.delete("/research-requests/".concat(e))}getPresetDataFields(e){return({basic_research:{demographics:{selected:!0,justification:"Basic demographics for patient characterization",subFields:{age:!0,gender:!0,region:!0}},diagnosisClassification:{selected:!0,justification:"Diagnosis and classification for tumor type analysis"},stagingData:{selected:!0,justification:"Staging data for disease severity assessment"}},outcome_study:{diagnosisClassification:{selected:!0,justification:"Diagnosis for outcome stratification"},stagingData:{selected:!0,justification:"Staging for baseline disease severity"},treatmentManagement:{selected:!0,justification:"Treatment details for outcome correlation"},followUpOutcomes:{selected:!0,justification:"Follow-up data and MSTS scores for outcome measurement"}},survival_analysis:{demographics:{selected:!0,justification:"Age and demographics as survival predictors",subFields:{age:!0,gender:!0}},diagnosisClassification:{selected:!0,justification:"Tumor type and grade for survival analysis"},stagingData:{selected:!0,justification:"Stage is primary survival predictor"},treatmentManagement:{selected:!0,justification:"Treatment modality affects survival"},followUpOutcomes:{selected:!0,justification:"Survival status and duration",subFields:{survivalStatus:!0,survivalDuration:!0}}},treatment_comparison:{diagnosisClassification:{selected:!0,justification:"Diagnosis for treatment stratification"},stagingData:{selected:!0,justification:"Baseline staging for comparison groups"},treatmentManagement:{selected:!0,justification:"Treatment details for comparison"},followUpOutcomes:{selected:!0,justification:"Outcomes for treatment effectiveness comparison"}}})[e]||{}}async generateExport(e){let t=await s.Z.post("/research-requests/".concat(e,"/generate-export"));return t.data}async getDownloadUrl(e){let t=await s.Z.get("/research-requests/".concat(e,"/download"));return t.data}async requestExtension(e,t,a){let i=await s.Z.post("/research-requests/".concat(e,"/request-extension"),{extensionMonths:t,justification:a});return i.data}}let r=new i;t.Z=r},4033:function(e,t,a){e.exports=a(94)}},function(e){e.O(0,[1176,4829,2849,4968,2971,2472,1744],function(){return e(e.s=3204)}),_N_E=e.O()}]);