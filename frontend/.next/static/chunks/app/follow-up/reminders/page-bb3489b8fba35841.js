(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3005],{3727:function(e,t,s){Promise.resolve().then(s.bind(s,3851))},3851:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var l=s(7437),a=s(2265),i=s(2849),r=s(4968),n=s(7821),d=s(4033);function c(){let{user:e,isAuthenticated:t,isLoading:s}=(0,i.useAuth)(),c=(0,d.useRouter)(),[o,x]=(0,a.useState)(!0),[m,u]=(0,a.useState)([]),[h,p]=(0,a.useState)([]),[g,y]=(0,a.useState)(7),[b,j]=(0,a.useState)(new Set);(0,a.useEffect)(()=>{if(!s&&!t){c.push("/login");return}t&&f()},[t,s,c]);let f=async()=>{try{x(!0);let e=await n.Z.getAllVisits(void 0,"scheduled");u(e);let t=new Date,s=e.map(e=>{var s,l;let a=new Date(e.scheduledDate),i=a.getTime()-t.getTime();return{id:e.id,patientId:e.patientId,patientName:(null===(s=e.patient)||void 0===s?void 0:s.name)||"Unknown",mrNumber:(null===(l=e.patient)||void 0===l?void 0:l.hospitalRecordNumber)||"-",visitNumber:e.visitNumber,scheduledDate:e.scheduledDate,daysUntil:Math.ceil(i/864e5),reminderSent:e.reminderSent||!1,status:e.reminderSent?"sent":"pending"}}).filter(e=>e.daysUntil<=30&&e.daysUntil>=-2).sort((e,t)=>e.daysUntil-t.daysUntil);p(s)}catch(e){console.error("Error loading reminder data:",e)}finally{x(!1)}},N=e=>{let t=new Set(b);t.has(e)?t.delete(e):t.add(e),j(t)},w=()=>{let e=h.filter(e=>e.daysUntil<=g).map(e=>e.id);j(new Set(e))},v=()=>{j(new Set)},S=async()=>{try{x(!0);let e=Array.from(b);for(let t of e)await n.Z.updateVisit(t,{reminderSent:!0,reminderDate:new Date().toISOString(),reminderMethod:"Manual/Email"});alert("✅ Success!\n\n"+"".concat(b.size," reminders have been tracked as SENT manually.\n\n")+"Note: Automated sending via SMS/WhatsApp is still in development."),await f(),v()}catch(e){console.error("Error sending reminders:",e),alert("Error updating reminder status. Please try again.")}finally{x(!1)}},D=e=>e<=1?(0,l.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"Urgent"}):e<=3?(0,l.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800",children:"High"}):e<=7?(0,l.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:"Medium"}):(0,l.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Low"}),k=h.filter(e=>e.daysUntil<=g);return s||o?(0,l.jsx)(r.A,{children:(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,l.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading reminder queue..."})]})})}):(0,l.jsxs)(r.A,{children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Follow-up Reminder Management"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Automated reminder system for upcoming follow-up visits"})]}),(0,l.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("span",{className:"text-2xl mr-3",children:"\uD83D\uDEA7"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-yellow-900",children:"Feature In Development"}),(0,l.jsx)("p",{className:"text-sm text-yellow-800 mt-1",children:"Automated SMS/Email reminder system requires backend integration with notification service. This page currently shows the reminder queue and allows manual tracking."})]})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total in Queue"}),(0,l.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:h.length})]}),(0,l.jsx)("div",{className:"text-4xl",children:"\uD83D\uDCCB"})]})}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Need Reminder"}),(0,l.jsx)("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:k.length})]}),(0,l.jsx)("div",{className:"text-4xl",children:"\uD83D\uDD14"})]}),(0,l.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Within ",g," days"]})]}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Urgent (≤3 days)"}),(0,l.jsx)("p",{className:"text-3xl font-bold text-red-600 mt-2",children:h.filter(e=>e.daysUntil<=3).length})]}),(0,l.jsx)("div",{className:"text-4xl",children:"\uD83D\uDEA8"})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Selected"}),(0,l.jsx)("p",{className:"text-3xl font-bold text-green-600 mt-2",children:b.size})]}),(0,l.jsx)("div",{className:"text-4xl",children:"✅"})]})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reminder Settings"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Send Reminder (Days Before Visit)"}),(0,l.jsxs)("select",{value:g,onChange:e=>y(parseInt(e.target.value)),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:1,children:"1 day before"}),(0,l.jsx)("option",{value:3,children:"3 days before"}),(0,l.jsx)("option",{value:7,children:"7 days before"}),(0,l.jsx)("option",{value:14,children:"14 days before"}),(0,l.jsx)("option",{value:30,children:"30 days before"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reminder Method"}),(0,l.jsx)("select",{disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500",children:(0,l.jsx)("option",{children:"SMS + Email (Default)"})}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Requires backend configuration"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reminder Template"}),(0,l.jsx)("select",{disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500",children:(0,l.jsx)("option",{children:"Default Template"})}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Requires backend configuration"})]})]})]}),k.length>0&&(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("button",{onClick:w,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:["Select All (",k.length,")"]}),(0,l.jsx)("button",{onClick:v,className:"text-sm text-gray-600 hover:text-gray-800 font-medium",children:"Clear Selection"})]}),(0,l.jsxs)("button",{onClick:S,disabled:0===b.size,className:"px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:["\uD83D\uDCE7 Send Reminders (",b.size,")"]})]})}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,l.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,l.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Reminder Queue (",h.length," visits)"]})}),0===h.length?(0,l.jsxs)("div",{className:"p-12 text-center text-gray-500",children:[(0,l.jsx)("div",{className:"text-6xl mb-4",children:"✉️"}),(0,l.jsx)("p",{className:"text-lg font-medium",children:"No upcoming visits"}),(0,l.jsx)("p",{className:"text-sm mt-2",children:"All visits are completed or scheduled beyond 30 days"})]}):(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left",children:(0,l.jsx)("input",{type:"checkbox",checked:b.size===k.length&&k.length>0,onChange:()=>{b.size===k.length?v():w()},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"MR Number"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Visit #"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Scheduled Date"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Days Until"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsx)("input",{type:"checkbox",checked:b.has(e.id),onChange:()=>N(e.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.patientName})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("div",{className:"text-sm text-gray-900",children:e.mrNumber})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800",children:["Visit #",e.visitNumber]})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("div",{className:"text-sm text-gray-900",children:new Date(e.scheduledDate).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("div",{className:"text-sm font-semibold ".concat(e.daysUntil<=1?"text-red-600":e.daysUntil<=3?"text-orange-600":e.daysUntil<=7?"text-yellow-600":"text-gray-600"),children:0===e.daysUntil?"Today":1===e.daysUntil?"Tomorrow":"".concat(e.daysUntil," days")})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:D(e.daysUntil)}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.reminderSent?(0,l.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"Sent"}):(0,l.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:"Pending"})})]},e.id))})]})})]}),(0,l.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mt-8",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:"ℹ️ About Automated Reminders"}),(0,l.jsxs)("div",{className:"text-sm text-blue-800 space-y-2",children:[(0,l.jsx)("p",{children:(0,l.jsx)("strong",{children:"When implemented, the reminder system will:"})}),(0,l.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[(0,l.jsx)("li",{children:"Automatically send SMS/Email reminders based on configured schedule"}),(0,l.jsx)("li",{children:"Track delivery status and failed attempts"}),(0,l.jsx)("li",{children:"Support custom reminder templates"}),(0,l.jsx)("li",{children:"Allow bulk reminder sending for multiple patients"}),(0,l.jsx)("li",{children:"Provide reminder history and analytics"}),(0,l.jsx)("li",{children:"Support WhatsApp Business API integration (optional)"})]}),(0,l.jsx)("p",{className:"mt-4",children:(0,l.jsx)("strong",{children:"Required Backend Services:"})}),(0,l.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[(0,l.jsx)("li",{children:"SMS Gateway (Twilio, AWS SNS, or local provider)"}),(0,l.jsx)("li",{children:"Email Service (SendGrid, AWS SES, or SMTP)"}),(0,l.jsx)("li",{children:"Notification Queue (Bull/Redis)"}),(0,l.jsx)("li",{children:"Scheduled Jobs (Cron or Task Scheduler)"})]})]})]})]})}},7821:function(e,t,s){"use strict";var l=s(762);class a{async generateSchedule(e){let t=await l.Z.post("/follow-ups/generate-schedule",e);return t.data}async createVisit(e){let t=await l.Z.post("/follow-ups",e);return t.data}async getAllVisits(e,t){let s={};e&&(s.patientId=e),t&&(s.status=t);let a=await l.Z.get("/follow-ups",{params:s});return a.data}async getVisitById(e){let t=await l.Z.get("/follow-ups/".concat(e));return t.data}async getVisitsByPatient(e){let t=await l.Z.get("/follow-ups/patient/".concat(e));return t.data}async getPatientSummary(e){let t=await l.Z.get("/follow-ups/patient/".concat(e,"/summary"));return t.data}async updateVisit(e,t){let s=await l.Z.put("/follow-ups/".concat(e),t);return s.data}async deleteVisit(e){await l.Z.delete("/follow-ups/".concat(e))}getStatusColor(e){return({scheduled:"blue",completed:"green",missed:"red",cancelled:"gray"})[e]||"gray"}getClinicalStatusColor(e){return({NED:"green",AWD:"yellow",DOD:"red",DOC:"gray"})[e||""]||"gray"}}t.Z=new a},4033:function(e,t,s){e.exports=s(94)}},function(e){e.O(0,[1176,4829,2849,4968,2971,2472,1744],function(){return e(e.s=3727)}),_N_E=e.O()}]);