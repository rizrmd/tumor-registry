(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5],{3584:function(e,t,s){Promise.resolve().then(s.bind(s,6990))},6990:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(7437),l=s(2265),i=s(2849),r=s(4968),n=s(7821),d=s(4033);function c(){let{user:e,isAuthenticated:t,isLoading:s}=(0,i.useAuth)(),c=(0,d.useRouter)(),[o,u]=(0,l.useState)(!0),[x,m]=(0,l.useState)({totalActivePatients:0,upcomingVisits:0,overdueVisits:0,complianceRate:0}),[h,p]=(0,l.useState)([]),[g,f]=(0,l.useState)([]),[v,j]=(0,l.useState)("all"),[y,N]=(0,l.useState)("all"),[b,w]=(0,l.useState)("");(0,l.useEffect)(()=>{if(!s&&!t){c.push("/login");return}t&&D()},[t,s,c]),(0,l.useEffect)(()=>{C()},[h,v,y,b]);let D=async()=>{try{u(!0);let e=await n.Z.getAllVisits();p(e);let t=new Date,s=new Set(e.map(e=>e.patientId)).size,a=e.filter(e=>"scheduled"===e.status),l=a.filter(e=>{let s=new Date(e.scheduledDate),a=Math.ceil((s.getTime()-t.getTime())/864e5);return a>=0&&a<=30}),i=a.filter(e=>{let s=new Date(e.scheduledDate);return s<t}),r=e.filter(e=>"completed"===e.status).length,d=e.length;m({totalActivePatients:s,upcomingVisits:l.length,overdueVisits:i.length,complianceRate:d>0?Math.round(r/d*100):0})}catch(e){console.error("Error loading follow-up data:",e)}finally{u(!1)}},C=()=>{let e=[...h];if("all"!==v){if("overdue"===v){let t=new Date;e=e.filter(e=>{let s=new Date(e.scheduledDate);return"scheduled"===e.status&&s<t})}else e=e.filter(e=>e.status===v)}"all"!==y&&(e=e.filter(e=>e.visitNumber===parseInt(y))),b&&(e=e.filter(e=>{var t,s,a,l,i,r;return(null===(s=e.patient)||void 0===s?void 0:null===(t=s.name)||void 0===t?void 0:t.toLowerCase().includes(b.toLowerCase()))||(null===(l=e.patient)||void 0===l?void 0:null===(a=l.inamsosRecordNumber)||void 0===a?void 0:a.toLowerCase().includes(b.toLowerCase()))||(null===(r=e.patient)||void 0===r?void 0:null===(i=r.hospitalRecordNumber)||void 0===i?void 0:i.toLowerCase().includes(b.toLowerCase()))})),e.sort((e,t)=>new Date(e.scheduledDate).getTime()-new Date(t.scheduledDate).getTime()),f(e)},V=e=>{let t=new Date,s=new Date(e.scheduledDate),l="scheduled"===e.status&&s<t;if(l)return(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"Overdue"});let i={scheduled:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",missed:"bg-red-100 text-red-800",cancelled:"bg-gray-100 text-gray-800"}[e.status]||"bg-gray-100 text-gray-800";return(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(i),children:e.status})},S=e=>{let t=new Date,s=new Date(e),a=s.getTime()-t.getTime(),l=Math.ceil(a/864e5);return l<0?"".concat(Math.abs(l)," days overdue"):0===l?"Today":1===l?"Tomorrow":"in ".concat(l," days")};return s||o?(0,a.jsx)(r.A,{children:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading follow-up data..."})]})})}):(0,a.jsxs)(r.A,{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"14-Visit Follow-up Protocol"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Monitor and manage longitudinal follow-up visits over 5 years"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Patients"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:x.totalActivePatients})]}),(0,a.jsx)("div",{className:"text-4xl",children:"\uD83D\uDC65"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Upcoming (30 days)"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:x.upcomingVisits})]}),(0,a.jsx)("div",{className:"text-4xl",children:"\uD83D\uDCC5"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Overdue Visits"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-red-600 mt-2",children:x.overdueVisits})]}),(0,a.jsx)("div",{className:"text-4xl",children:"\uD83D\uDEA8"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Compliance Rate"}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-green-600 mt-2",children:[x.complianceRate,"%"]})]}),(0,a.jsx)("div",{className:"text-4xl",children:"âœ…"})]})})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Patient"}),(0,a.jsx)("input",{type:"text",value:b,onChange:e=>w(e.target.value),placeholder:"Name or MR Number",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,a.jsxs)("select",{value:v,onChange:e=>j(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Statuses"}),(0,a.jsx)("option",{value:"scheduled",children:"Scheduled"}),(0,a.jsx)("option",{value:"overdue",children:"Overdue"}),(0,a.jsx)("option",{value:"completed",children:"Completed"}),(0,a.jsx)("option",{value:"missed",children:"Missed"}),(0,a.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Visit Number"}),(0,a.jsxs)("select",{value:y,onChange:e=>N(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Visits"}),[...Array(14)].map((e,t)=>(0,a.jsxs)("option",{value:t+1,children:["Visit #",t+1]},t+1))]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:D,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"\uD83D\uDD04 Refresh"})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Follow-up Visits (",g.length,")"]})}),0===g.length?(0,a.jsxs)("div",{className:"p-12 text-center text-gray-500",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCC5"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:"No visits found"}),(0,a.jsx)("p",{className:"text-sm mt-2",children:"Try adjusting your filters or search query"})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"MR Number"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Visit #"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Scheduled Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Days Until"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(e=>{var t,s,l;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(null===(t=e.patient)||void 0===t?void 0:t.name)||"Unknown"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:(null===(s=e.patient)||void 0===s?void 0:s.inamsosRecordNumber)||(null===(l=e.patient)||void 0===l?void 0:l.hospitalRecordNumber)||"-"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800",children:["Visit #",e.visitNumber]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:new Date(e.scheduledDate).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-600",children:S(e.scheduledDate)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:V(e)}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,a.jsx)("button",{onClick:()=>c.push("/patients/".concat(e.patientId)),className:"text-blue-600 hover:text-blue-900 mr-3",children:"View Patient"}),"scheduled"===e.status&&(0,a.jsx)("button",{onClick:()=>c.push("/demo/follow-up-calendar?patient=".concat(e.patientId)),className:"text-green-600 hover:text-green-900",children:"Enter Data"})]})]},e.id)})})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mt-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Visit Completion Rate by Visit Number"}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-2",children:[...Array(14)].map((e,t)=>{let s=t+1,l=h.filter(e=>e.visitNumber===s).length,i=h.filter(e=>e.visitNumber===s&&"completed"===e.status).length,r=l>0?Math.round(i/l*100):0;return(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsxs)("div",{className:"text-xs font-medium text-gray-600 mb-1",children:["V",s]}),(0,a.jsx)("div",{className:"bg-blue-500 rounded-t",style:{height:"".concat(Math.max(r,5),"px")},title:"".concat(r,"% completed")}),(0,a.jsxs)("div",{className:"text-xs font-semibold text-gray-900 mt-1",children:[r,"%"]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[i,"/",l]})]},s)})})]})]})}},7821:function(e,t,s){"use strict";var a=s(762);class l{async generateSchedule(e){let t=await a.Z.post("/follow-ups/generate-schedule",e);return t.data}async createVisit(e){let t=await a.Z.post("/follow-ups",e);return t.data}async getAllVisits(e,t){let s={};e&&(s.patientId=e),t&&(s.status=t);let l=await a.Z.get("/follow-ups",{params:s});return l.data}async getVisitById(e){let t=await a.Z.get("/follow-ups/".concat(e));return t.data}async getVisitsByPatient(e){let t=await a.Z.get("/follow-ups/patient/".concat(e));return t.data}async getPatientSummary(e){let t=await a.Z.get("/follow-ups/patient/".concat(e,"/summary"));return t.data}async updateVisit(e,t){let s=await a.Z.put("/follow-ups/".concat(e),t);return s.data}async deleteVisit(e){await a.Z.delete("/follow-ups/".concat(e))}getStatusColor(e){return({scheduled:"blue",completed:"green",missed:"red",cancelled:"gray"})[e]||"gray"}getClinicalStatusColor(e){return({NED:"green",AWD:"yellow",DOD:"red",DOC:"gray"})[e||""]||"gray"}}t.Z=new l},4033:function(e,t,s){e.exports=s(94)}},function(e){e.O(0,[1176,4829,2849,4968,2971,2472,1744],function(){return e(e.s=3584)}),_N_E=e.O()}]);