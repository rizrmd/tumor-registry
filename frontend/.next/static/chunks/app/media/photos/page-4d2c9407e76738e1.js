(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9559],{2485:function(e,t,s){Promise.resolve().then(s.bind(s,8204))},8204:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var l=s(7437),a=s(2265),i=s(6986),r=s(7372),n=s(6579),o=s(4033);function d(){let{user:e,isAuthenticated:t,isLoading:s}=(0,i.useAuth)(),d=(0,o.useRouter)(),[c,x]=(0,a.useState)(!0),[u,m]=(0,a.useState)([]),[h,p]=(0,a.useState)([]),[g,b]=(0,a.useState)(""),[j,f]=(0,a.useState)("all"),[y,v]=(0,a.useState)(null),[N,w]=(0,a.useState)(!1),[D,L]=(0,a.useState)(!1),[C,T]=(0,a.useState)(null),[k,P]=(0,a.useState)(""),[R,E]=(0,a.useState)(""),[S,A]=(0,a.useState)(""),[I,F]=(0,a.useState)("");(0,a.useEffect)(()=>{if(!s&&!t){d.push("/login");return}t&&O()},[t,s,d]),(0,a.useEffect)(()=>{U()},[u,g,j]);let O=async()=>{try{x(!0),m([])}catch(e){console.error("Error loading clinical photos:",e)}finally{x(!1)}},U=()=>{let e=[...u];g&&(e=e.filter(e=>{var t,s,l;return(null===(t=e.patientName)||void 0===t?void 0:t.toLowerCase().includes(g.toLowerCase()))||(null===(s=e.mrNumber)||void 0===s?void 0:s.toLowerCase().includes(g.toLowerCase()))||(null===(l=e.description)||void 0===l?void 0:l.toLowerCase().includes(g.toLowerCase()))})),"all"!==j&&(e=e.filter(e=>e.viewType===j)),e.sort((e,t)=>new Date(t.uploadDate).getTime()-new Date(e.uploadDate).getTime()),p(e)},M=async()=>{if(!C||!R){alert("Please select a file and enter patient ID");return}try{w(!0),await n.Z.uploadPhoto({patientId:R,file:C,viewType:S,description:I}),alert("Photo uploaded successfully!"),T(null),P(""),E(""),A(""),F(""),L(!1),O()}catch(e){console.error("Error uploading photo:",e),alert("Failed to upload photo. Please try again.")}finally{w(!1)}},_=async e=>{if(confirm("Are you sure you want to delete this photo?"))try{await n.Z.deletePhoto(e),alert("Photo deleted successfully"),O(),v(null)}catch(e){console.error("Error deleting photo:",e),alert("Failed to delete photo")}},z=e=>{let t={ANTERIOR:"bg-blue-100 text-blue-800",POSTERIOR:"bg-green-100 text-green-800",LATERAL_LEFT:"bg-purple-100 text-purple-800",LATERAL_RIGHT:"bg-pink-100 text-pink-800",OTHER:"bg-gray-100 text-gray-800"}[e||""]||"bg-gray-100 text-gray-800";return(0,l.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(t),children:e||"Unknown"})};return s||c?(0,l.jsx)(r.A,{children:(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,l.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading clinical photos..."})]})})}):(0,l.jsxs)(r.A,{children:[(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Clinical Photos Management"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Upload and manage clinical photography documentation"})]}),(0,l.jsxs)("button",{onClick:()=>L(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"\uD83D\uDCF8"}),"Upload Photo"]})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Photos"}),(0,l.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:u.length})]}),(0,l.jsx)("div",{className:"text-4xl",children:"\uD83D\uDDBCï¸"})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"This Month"}),(0,l.jsx)("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:u.filter(e=>{let t=new Date(e.uploadDate),s=new Date;return t.getMonth()===s.getMonth()&&t.getFullYear()===s.getFullYear()}).length})]}),(0,l.jsx)("div",{className:"text-4xl",children:"\uD83D\uDCC5"})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Patients"}),(0,l.jsx)("p",{className:"text-3xl font-bold text-green-600 mt-2",children:new Set(u.map(e=>e.patientId)).size})]}),(0,l.jsx)("div",{className:"text-4xl",children:"\uD83D\uDC65"})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Size"}),(0,l.jsxs)("p",{className:"text-3xl font-bold text-purple-600 mt-2",children:[(u.reduce((e,t)=>e+(t.fileSize||0),0)/1048576).toFixed(1),(0,l.jsx)("span",{className:"text-sm ml-1",children:"MB"})]})]}),(0,l.jsx)("div",{className:"text-4xl",children:"\uD83D\uDCBE"})]})})]}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),(0,l.jsx)("input",{type:"text",value:g,onChange:e=>b(e.target.value),placeholder:"Patient name, MR number, or description",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"View Type"}),(0,l.jsxs)("select",{value:j,onChange:e=>f(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"all",children:"All Views"}),(0,l.jsx)("option",{value:"ANTERIOR",children:"Anterior"}),(0,l.jsx)("option",{value:"POSTERIOR",children:"Posterior"}),(0,l.jsx)("option",{value:"LATERAL_LEFT",children:"Lateral Left"}),(0,l.jsx)("option",{value:"LATERAL_RIGHT",children:"Lateral Right"}),(0,l.jsx)("option",{value:"OTHER",children:"Other"})]})]})]})}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:["Clinical Photos (",h.length,")"]}),0===h.length?(0,l.jsxs)("div",{className:"p-12 text-center text-gray-500",children:[(0,l.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCF8"}),(0,l.jsx)("p",{className:"text-lg font-medium",children:"No clinical photos found"}),(0,l.jsx)("p",{className:"text-sm mt-2",children:0===u.length?"Start by uploading clinical photos for your patients":"Try adjusting your search filters"}),(0,l.jsx)("button",{onClick:()=>L(!0),className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Upload First Photo"})]}):(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:h.map(e=>(0,l.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>v(e),children:[(0,l.jsxs)("div",{className:"aspect-square bg-gray-100 relative",children:[(0,l.jsx)("img",{src:e.fileUrl,alt:e.description||"Clinical photo",className:"w-full h-full object-cover"}),(0,l.jsx)("div",{className:"absolute top-2 right-2",children:z(e.viewType)})]}),(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-900 truncate",children:e.patientName||"Unknown Patient"}),(0,l.jsx)("p",{className:"text-sm text-gray-600 truncate",children:e.mrNumber||"-"}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-2 line-clamp-2",children:e.description||"No description"}),(0,l.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:new Date(e.uploadDate).toLocaleDateString("id-ID")})]})]},e.id))})]}),D&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,l.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Upload Clinical Photo"}),(0,l.jsx)("button",{onClick:()=>!N&&L(!1),className:"text-gray-400 hover:text-gray-600",disabled:N,children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,l.jsxs)("div",{className:"p-6 space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Photo File *"}),(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!s)return;if(!s.type.startsWith("image/")){alert("Please select an image file");return}if(s.size>10485760){alert("File size must be less than 10MB");return}T(s);let l=new FileReader;l.onloadend=()=>{P(l.result)},l.readAsDataURL(s)},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N}),k&&(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("img",{src:k,alt:"Preview",className:"w-full max-h-64 object-contain rounded-lg border border-gray-200"})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patient ID *"}),(0,l.jsx)("input",{type:"text",value:R,onChange:e=>E(e.target.value),placeholder:"Enter patient ID",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"View Type"}),(0,l.jsxs)("select",{value:S,onChange:e=>A(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N,children:[(0,l.jsx)("option",{value:"",children:"Select view type"}),(0,l.jsx)("option",{value:"ANTERIOR",children:"Anterior"}),(0,l.jsx)("option",{value:"POSTERIOR",children:"Posterior"}),(0,l.jsx)("option",{value:"LATERAL_LEFT",children:"Lateral Left"}),(0,l.jsx)("option",{value:"LATERAL_RIGHT",children:"Lateral Right"}),(0,l.jsx)("option",{value:"OTHER",children:"Other"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,l.jsx)("textarea",{value:I,onChange:e=>F(e.target.value),rows:3,placeholder:"Photo description (optional)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N})]})]}),(0,l.jsxs)("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[(0,l.jsx)("button",{onClick:()=>L(!1),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",disabled:N,children:"Cancel"}),(0,l.jsx)("button",{onClick:M,disabled:N||!C||!R,className:"px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:N?"Uploading...":"Upload Photo"})]})]})}),y&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,l.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Clinical Photo Detail"}),(0,l.jsx)("button",{onClick:()=>v(null),className:"text-gray-400 hover:text-gray-600",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)("img",{src:y.fileUrl,alt:y.description||"Clinical photo",className:"w-full rounded-lg"})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Patient"}),(0,l.jsx)("p",{className:"font-semibold",children:y.patientName||"Unknown"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"MR Number"}),(0,l.jsx)("p",{className:"font-semibold",children:y.mrNumber||"-"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"View Type"}),(0,l.jsx)("div",{className:"mt-1",children:z(y.viewType)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Upload Date"}),(0,l.jsx)("p",{className:"font-semibold",children:new Date(y.uploadDate).toLocaleString("id-ID")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"File Size"}),(0,l.jsx)("p",{className:"font-semibold",children:y.fileSize?"".concat((y.fileSize/1024).toFixed(1)," KB"):"Unknown"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Uploaded By"}),(0,l.jsx)("p",{className:"font-semibold",children:y.uploadedBy||"-"})]})]}),y.description&&(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Description"}),(0,l.jsx)("p",{className:"text-gray-900",children:y.description})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,l.jsx)("button",{onClick:()=>window.open(y.fileUrl,"_blank"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Download"}),(0,l.jsx)("button",{onClick:()=>_(y.id),className:"px-6 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Delete"})]})]})]})})]})}},6579:function(e,t,s){"use strict";var l=s(6383);class a{async uploadPhoto(e){let t=new FormData;return t.append("file",e.file),t.append("patientId",e.patientId),e.viewType&&t.append("viewType",e.viewType),e.anatomicalLocation&&t.append("anatomicalLocation",e.anatomicalLocation),e.description&&t.append("description",e.description),(await l.Z.post("/clinical-photos/upload",t,{headers:{"Content-Type":"multipart/form-data"}})).data}async uploadMultiplePhotos(e,t){let s=t.map(t=>this.uploadPhoto({patientId:e,file:t.file,viewType:t.viewAngle,description:t.description}));return await Promise.all(s)}async getPhotosByPatient(e){return(await l.Z.get("/clinical-photos/patient/".concat(e))).data}async deletePhoto(e){return(await l.Z.delete("/clinical-photos/".concat(e))).data}}t.Z=new a},4033:function(e,t,s){e.exports=s(5313)}},function(e){e.O(0,[4737,1956,7372,2971,4938,1744],function(){return e(e.s=2485)}),_N_E=e.O()}]);