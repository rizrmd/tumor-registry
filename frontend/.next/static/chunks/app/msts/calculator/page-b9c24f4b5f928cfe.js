(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2884],{3524:function(t,e,a){Promise.resolve().then(a.bind(a,2778))},2778:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return m}});var s=a(7437),n=a(2265),i=a(4033),r=a(2849),l=a(143),c=a(4968),d=a(829),o=a(6712);function u(){let t=(0,i.useSearchParams)(),e=(0,i.useRouter)(),{isAuthenticated:a,isLoading:c}=(0,r.useAuth)(),[u,m]=(0,n.useState)(!0),[x,h]=(0,n.useState)(null),[p,g]=(0,n.useState)([]),b=t.get("patientId");(0,n.useEffect)(()=>{if(!c&&!a){e.push("/login");return}a&&(b?(y(),f()):e.push("/msts"))},[a,c,b,e]);let y=async()=>{if(b)try{m(!0);let t=await d.Z.getPatientById(b);h(t)}catch(t){console.error("Error loading patient:",t),alert("Failed to load patient data"),e.push("/msts")}finally{m(!1)}},f=async()=>{if(b)try{let t=await o.Z.getPatientHistory(b);g(t.scores||[])}catch(t){console.error("Error loading MSTS history:",t),g([])}},j=async t=>{console.log("MSTS score saved with ID:",t),await f()};return c||u?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading patient data..."})]})}):x&&b?(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsx)("div",{className:"mb-6 flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{onClick:()=>e.push("/msts"),className:"text-blue-600 hover:text-blue-700 font-medium mb-2 flex items-center",children:"← Back to Patient Selection"}),(0,s.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["MSTS Score Calculator - ",x.name]}),(0,s.jsxs)("p",{className:"text-gray-600",children:["MR Number: ",x.hospitalRecordNumber]})]})}),p&&p.length>0&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Previous Assessments"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:p.slice(0,3).map(t=>(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500",children:new Date(t.assessmentDate).toLocaleDateString("id-ID")}),(0,s.jsxs)("span",{className:"text-lg font-bold text-blue-600",children:[t.totalScore,"/30"]})]}),(0,s.jsxs)("p",{className:"text-xs text-gray-600",children:["By: ",t.assessedBy]})]},t.id))}),p.length>3&&(0,s.jsxs)("button",{onClick:()=>e.push("/patients/view?id=".concat(b)),className:"mt-4 text-sm text-blue-600 hover:text-blue-700",children:["View all ",p.length," assessments →"]})]}),(0,s.jsx)(l.K,{patientId:b,patientName:x.name,autoSave:!0,onSave:j})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("p",{className:"text-red-600",children:"Patient not found"}),(0,s.jsx)("button",{onClick:()=>e.push("/msts"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg",children:"Back to Patient Selection"})]})}function m(){return(0,s.jsx)(c.A,{children:(0,s.jsx)(n.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsx)(u,{})})})}},829:function(t,e,a){"use strict";var s=a(762);class n{async createPatient(t){let e=await s.Z.post("/patients",t);return e.data.data}async getPatients(t){var e;let a=await s.Z.get("/patients",{params:t});return{data:a.data.patients||[],meta:a.data.pagination||{page:1,limit:50,total:(null===(e=a.data.patients)||void 0===e?void 0:e.length)||0,totalPages:1}}}async getPatientById(t){let e=await s.Z.get("/patients/".concat(t));return e.data}async getPatientByMRN(t,e){let a=await s.Z.get("/patients/mrn/".concat(t),{params:{centerId:e}});return a.data.data}async updatePatient(t,e){let a=await s.Z.patch("/patients/".concat(t),e);return a.data.data}async deletePatient(t){await s.Z.delete("/patients/".concat(t))}async searchPatients(t,e){let a=await s.Z.get("/patients/search",{params:{q:t,centerId:e}});return a.data.data}async getPatientStatistics(t){let e=await s.Z.get("/patients/statistics",{params:{centerId:t}});return e.data.data}async exportPatients(t,e){let a=await s.Z.get("/patients/export/".concat(t),{params:e,responseType:"blob"});return a.data}}e.Z=new n}},function(t){t.O(0,[1176,4829,2849,4968,6504,2971,2472,1744],function(){return t(t.s=3524)}),_N_E=t.O()}]);