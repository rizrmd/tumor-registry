(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7413],{9309:function(e,t,r){Promise.resolve().then(r.bind(r,1990))},1990:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var l=r(7437),n=r(2265),a=r(7593);function s(){let{isWailsAvailable:e}=(0,a.p)(),[t,r]=(0,n.useState)(null),[s,o]=(0,n.useState)("");return((0,n.useEffect)(()=>{if(!e){window.location.href="/login";return}let t=async()=>{try{var e,t;let l=null===(t=window.go)||void 0===t?void 0:null===(e=t.main)||void 0===e?void 0:e.App;if(!l){o("Wails not available");return}let n=await l.CheckSetupStatus();r(n),n.backendRunning&&!n.isFirstRun&&(window.location.href="/login")}catch(e){console.error("Error checking setup status:",e),o("Failed to check setup status")}};t();let l=setInterval(t,2e3);return()=>clearInterval(l)},[e]),e)?s?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,l.jsx)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 bg-red-100 rounded-full",children:(0,l.jsx)("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,l.jsx)("h2",{className:"mt-4 text-xl font-semibold text-gray-900",children:"Setup Error"}),(0,l.jsx)("p",{className:"mt-2 text-gray-600",children:s}),(0,l.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-6 w-full inline-flex justify-center rounded-lg border border-transparent bg-emerald-600 px-4 py-2 text-sm font-medium text-white hover:bg-emerald-700",children:"Retry"})]})})}):(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-emerald-50 to-teal-50 p-4",children:(0,l.jsx)("div",{className:"max-w-2xl w-full",children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,l.jsx)("div",{className:"bg-gradient-to-r from-emerald-600 to-teal-600 p-8",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Setting Up INAMSOS"}),(0,l.jsx)("p",{className:"mt-2 text-emerald-100",children:"Initializing your local database and backend server..."})]})}),(0,l.jsxs)("div",{className:"p-8 space-y-6",children:[(0,l.jsx)(i,{title:"Checking Setup",status:(null==t?void 0:t.nodeInstalled)?"complete":"pending",description:"Verifying installation status"}),(0,l.jsx)(i,{title:"Installing Backend",status:(null==t?void 0:t.nodeInstalled)?"complete":"pending",description:"Downloading and installing dependencies (~300MB)"}),(0,l.jsx)(i,{title:"Starting Database",status:(null==t?void 0:t.dbInitialized)?"complete":"pending",description:"Initializing PostgreSQL database"}),(0,l.jsx)(i,{title:"Running Migrations",status:(null==t?void 0:t.backendRunning)?"complete":"pending",description:"Setting up database schema"}),(0,l.jsx)(i,{title:"Starting Backend",status:(null==t?void 0:t.backendRunning)?"complete":"in-progress",description:"Launching API server"}),(0,l.jsxs)("div",{className:"mt-8",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Overall Progress"}),(0,l.jsx)("span",{className:"text-sm text-gray-500",children:(null==t?void 0:t.backendRunning)?"Almost done...":"Please wait..."})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-500 h-2 rounded-full transition-all duration-500 ease-out",style:{width:(null==t?void 0:t.backendRunning)?"95%":"30%"}})})]}),(0,l.jsx)("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 001-1V9a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"One-Time Setup"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-blue-700",children:"This will only happen once. The backend server will start automatically on future launches. All data is stored locally on your computer."})]})]})}),(null==t?void 0:t.backendRunning)&&(0,l.jsx)("div",{className:"mt-8 bg-emerald-50 border border-emerald-200 rounded-lg p-4 text-center",children:(0,l.jsx)("p",{className:"text-emerald-800 font-medium",children:"Setup complete! Redirecting to login..."})})]})]})})}):(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-gray-600",children:"This page is only for desktop app setup..."}),(0,l.jsx)("a",{href:"/login",className:"text-blue-600 hover:underline",children:"Go to login"})]})})}function i(e){let{title:t,status:r,description:n}=e;return(0,l.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:"complete"===r?(0,l.jsx)("div",{className:"h-8 w-8 rounded-full bg-emerald-100 flex items-center justify-center",children:(0,l.jsx)("svg",{className:"h-5 w-5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):"in-progress"===r?(0,l.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:(0,l.jsxs)("svg",{className:"animate-spin h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):"error"===r?(0,l.jsx)("div",{className:"h-8 w-8 rounded-full bg-red-100 flex items-center justify-center",children:(0,l.jsx)("svg",{className:"h-5 w-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}):(0,l.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center",children:(0,l.jsx)("div",{className:"h-2 w-2 rounded-full bg-gray-400"})})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"text-sm font-medium ".concat("complete"===r?"text-emerald-700":"in-progress"===r?"text-blue-700":"error"===r?"text-red-700":"text-gray-500"),children:t}),(0,l.jsx)("p",{className:"text-sm ".concat("complete"===r?"text-emerald-600":"in-progress"===r?"text-blue-600":"error"===r?"text-red-600":"text-gray-400"),children:n})]})]})}},7593:function(e,t,r){"use strict";r.d(t,{p:function(){return a}});var l=r(2265);function n(){var e,t;return(null===(t=window.go)||void 0===t?void 0:null===(e=t.main)||void 0===e?void 0:e.App)||window.wails||null}function a(){let[e,t]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=()=>!!n()&&(t(!0),!0);if(e())return;let r=0,l=setInterval(()=>{r++,(e()||r>=50)&&(clearInterval(l),r>=50&&console.log("[useWails] Running in web mode (Wails not detected)"))},100);return()=>clearInterval(l)},[]);let r=(0,l.useCallback)(async()=>{let e=n();if(!e)return"web";try{return await e.GetAppVersion()}catch(e){return console.error("Failed to get app version:",e),"web"}},[]),a=(0,l.useCallback)(async()=>{let e=n();if(!e)return null;try{return await e.CheckForUpdates()}catch(e){return console.error("Failed to check for updates:",e),null}},[]),s=(0,l.useCallback)(async()=>{let e=n();if(!e)return null;try{return await e.GetCachedUpdateInfo()}catch(e){return console.error("Failed to get cached update info:",e),null}},[]),i=(0,l.useCallback)(async()=>{let e=n();if(!e)return null;try{return await e.CreateBackup()}catch(e){throw console.error("Failed to create backup:",e),e}},[]),o=(0,l.useCallback)(async()=>{let e=n();if(!e)return null;try{return await e.ListBackups()}catch(e){return console.error("Failed to list backups:",e),null}},[]),c=(0,l.useCallback)(async e=>{let t=n();if(t)try{await t.RestoreBackup(e)}catch(e){throw console.error("Failed to restore backup:",e),e}},[]),d=(0,l.useCallback)(async e=>{let t=n();if(t)try{await t.DeleteBackup(e)}catch(e){throw console.error("Failed to delete backup:",e),e}},[]),u=(0,l.useCallback)(async(e,t,r)=>{let l=n();if(l)try{await l.PerformUpdate(e,t,r)}catch(e){throw console.error("Failed to perform update:",e),e}},[]),m=(0,l.useCallback)(async(e,t)=>{let r=n();if(r)try{await r.ImportDataFromPath(e,t)}catch(e){throw console.error("Failed to import data:",e),e}},[]),h=(0,l.useCallback)(async(e,t)=>{let r=n();if(!r)return null;try{return await r.Login(e,t)}catch(e){return console.error("Login failed:",e),null}},[]);return{isWailsAvailable:e,GetAppVersion:r,CheckForUpdates:a,GetCachedUpdateInfo:s,CreateBackup:i,ListBackups:o,RestoreBackup:c,DeleteBackup:d,PerformUpdate:u,ImportDataFromPath:m,Login:h,Logout:(0,l.useCallback)(async()=>{let e=n();if(e)try{await e.Logout()}catch(e){console.error("Logout failed:",e)}},[]),GetAuthStatus:(0,l.useCallback)(async()=>{let e=n();if(!e)return null;try{return await e.GetAuthStatus()}catch(e){return console.error("Failed to get auth status:",e),null}},[]),GetCentralServerUrl:(0,l.useCallback)(async()=>{let e=n();if(!e)return"";try{return await e.GetCentralServerUrl()}catch(e){return console.error("Failed to get central server URL:",e),""}},[])}}},622:function(e,t,r){"use strict";var l=r(2265),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var l,a={},c=null,d=null;for(l in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,l)&&!o.hasOwnProperty(l)&&(a[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps)void 0===a[l]&&(a[l]=t[l]);return{$$typeof:n,type:e,key:c,ref:d,props:a,_owner:i.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},7437:function(e,t,r){"use strict";e.exports=r(622)}},function(e){e.O(0,[2971,4938,1744],function(){return e(e.s=9309)}),_N_E=e.O()}]);